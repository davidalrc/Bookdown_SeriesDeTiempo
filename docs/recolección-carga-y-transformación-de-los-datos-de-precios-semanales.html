<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 2 Recolección, carga y transformación de los datos de precios semanales | Pronóstico de precios mayoristas de alimentos del grupo de verduras y hortalizas haciendo uso de boletines semanales del Sistema de Información de Precios y Abastecimiento del Sector Agropecuario (SIPSA)</title>
  <meta name="description" content="Este libro tiene como finalidad explorar técnicas de pronóstico de series de tiempo para la predicción de precios mayoristas de algunos alimentos del grupo de verduras y hortalizas para las centrales de abasto de Armenia, Pereira y Manizales" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 2 Recolección, carga y transformación de los datos de precios semanales | Pronóstico de precios mayoristas de alimentos del grupo de verduras y hortalizas haciendo uso de boletines semanales del Sistema de Información de Precios y Abastecimiento del Sector Agropecuario (SIPSA)" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Este libro tiene como finalidad explorar técnicas de pronóstico de series de tiempo para la predicción de precios mayoristas de algunos alimentos del grupo de verduras y hortalizas para las centrales de abasto de Armenia, Pereira y Manizales" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 2 Recolección, carga y transformación de los datos de precios semanales | Pronóstico de precios mayoristas de alimentos del grupo de verduras y hortalizas haciendo uso de boletines semanales del Sistema de Información de Precios y Abastecimiento del Sector Agropecuario (SIPSA)" />
  
  <meta name="twitter:description" content="Este libro tiene como finalidad explorar técnicas de pronóstico de series de tiempo para la predicción de precios mayoristas de algunos alimentos del grupo de verduras y hortalizas para las centrales de abasto de Armenia, Pereira y Manizales" />
  

<meta name="author" content="David Alejandro Rivera Correa" />


<meta name="date" content="2023-08-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="análisis-exploratorio-de-las-series-de-tiempo.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Análisis series de tiempo- MCD</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Justificación y fuentes de información</a></li>
<li class="chapter" data-level="2" data-path="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html"><i class="fa fa-check"></i><b>2</b> Recolección, carga y transformación de los datos de precios semanales</a>
<ul>
<li class="chapter" data-level="2.0.1" data-path="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#funciones-para-el-pre-procesamiento-y-limpieza-de-los-boletines-para-el-periodo-2016-a-11-de-mayo-de-2018"><i class="fa fa-check"></i><b>2.0.1</b> Funciones para el pre-procesamiento y limpieza de los boletines para el periodo 2016 a 11 de Mayo de 2018</a></li>
<li class="chapter" data-level="2.0.2" data-path="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#funciones-para-el-pre-procesamiento-y-limpieza-de-los-boletines-para-el-periodo-de-mayo-de-2018-a-diciembre-de-2022"><i class="fa fa-check"></i><b>2.0.2</b> Funciones para el pre-procesamiento y limpieza de los boletines para el periodo de Mayo de 2018 a Diciembre de 2022</a></li>
<li class="chapter" data-level="2.0.3" data-path="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#limpieza-de-set-de-datos-consolidado-de-boletines-sipsa-2016-a-2022"><i class="fa fa-check"></i><b>2.0.3</b> Limpieza de set de datos consolidado de boletines SIPSA 2016 a 2022</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="análisis-exploratorio-de-las-series-de-tiempo.html"><a href="análisis-exploratorio-de-las-series-de-tiempo.html"><i class="fa fa-check"></i><b>3</b> Análisis exploratorio de las series de tiempo</a>
<ul>
<li class="chapter" data-level="3.1" data-path="análisis-exploratorio-de-las-series-de-tiempo.html"><a href="análisis-exploratorio-de-las-series-de-tiempo.html#análisis-de-series-de-tiempo-de-precio-promedio-mayorista-semanal-para-la-ciudad-de-armenia"><i class="fa fa-check"></i><b>3.1</b> Análisis de series de tiempo de precio promedio mayorista semanal para la ciudad de Armenia</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="análisis-exploratorio-de-las-series-de-tiempo.html"><a href="análisis-exploratorio-de-las-series-de-tiempo.html#ahuyama"><i class="fa fa-check"></i><b>3.1.1</b> Ahuyama</a></li>
<li class="chapter" data-level="3.1.2" data-path="análisis-exploratorio-de-las-series-de-tiempo.html"><a href="análisis-exploratorio-de-las-series-de-tiempo.html#cebolla-junca"><i class="fa fa-check"></i><b>3.1.2</b> Cebolla Junca</a></li>
<li class="chapter" data-level="3.1.3" data-path="análisis-exploratorio-de-las-series-de-tiempo.html"><a href="análisis-exploratorio-de-las-series-de-tiempo.html#habichuela"><i class="fa fa-check"></i><b>3.1.3</b> Habichuela</a></li>
<li class="chapter" data-level="3.1.4" data-path="análisis-exploratorio-de-las-series-de-tiempo.html"><a href="análisis-exploratorio-de-las-series-de-tiempo.html#tomate-chonto"><i class="fa fa-check"></i><b>3.1.4</b> Tomate Chonto</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="análisis-exploratorio-de-las-series-de-tiempo.html"><a href="análisis-exploratorio-de-las-series-de-tiempo.html#análisis-de-series-de-tiempo-de-precio-promedio-mayorista-semanal-para-la-ciudad-de-pereira"><i class="fa fa-check"></i><b>3.2</b> Análisis de series de tiempo de precio promedio mayorista semanal para la ciudad de Pereira</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="análisis-exploratorio-de-las-series-de-tiempo.html"><a href="análisis-exploratorio-de-las-series-de-tiempo.html#ahuyama-1"><i class="fa fa-check"></i><b>3.2.1</b> Ahuyama</a></li>
<li class="chapter" data-level="3.2.2" data-path="análisis-exploratorio-de-las-series-de-tiempo.html"><a href="análisis-exploratorio-de-las-series-de-tiempo.html#cebolla-junca-1"><i class="fa fa-check"></i><b>3.2.2</b> Cebolla Junca</a></li>
<li class="chapter" data-level="3.2.3" data-path="análisis-exploratorio-de-las-series-de-tiempo.html"><a href="análisis-exploratorio-de-las-series-de-tiempo.html#habichuela-1"><i class="fa fa-check"></i><b>3.2.3</b> Habichuela</a></li>
<li class="chapter" data-level="3.2.4" data-path="análisis-exploratorio-de-las-series-de-tiempo.html"><a href="análisis-exploratorio-de-las-series-de-tiempo.html#tomate-chonto-1"><i class="fa fa-check"></i><b>3.2.4</b> Tomate Chonto</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modelación-para-el-pronóstico-de-las-series-de-tiempo.html"><a href="modelación-para-el-pronóstico-de-las-series-de-tiempo.html"><i class="fa fa-check"></i><b>4</b> Modelación para el pronóstico de las series de tiempo</a></li>
<li class="chapter" data-level="5" data-path="evaluación-y-ajuste-de-hiperparámetros-de-los-modelos.html"><a href="evaluación-y-ajuste-de-hiperparámetros-de-los-modelos.html"><i class="fa fa-check"></i><b>5</b> Evaluación y ajuste de hiperparámetros de los modelos</a></li>
<li class="chapter" data-level="6" data-path="contraste-entre-series-de-tiempo-y-proyección-de-precios-minoristas.html"><a href="contraste-entre-series-de-tiempo-y-proyección-de-precios-minoristas.html"><i class="fa fa-check"></i><b>6</b> Contraste entre series de tiempo y proyección de precios minoristas</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Pronóstico de precios mayoristas de alimentos del grupo de verduras y hortalizas haciendo uso de boletines semanales del Sistema de Información de Precios y Abastecimiento del Sector Agropecuario (SIPSA)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="recolección-carga-y-transformación-de-los-datos-de-precios-semanales" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Capítulo 2</span> Recolección, carga y transformación de los datos de precios semanales<a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#recolección-carga-y-transformación-de-los-datos-de-precios-semanales" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Para desarrollar los elementos mencionados en la sección introductoria es relevante tener en cuenta que el SIPSA presenta diferentes tipos de boletín, presenta boletines diarios para un conjunto predefinido de alimentos conformados por frutas, verduras y hortalizas, y seguidamente publica boletines semanales en donde esta presente una variedad mucho más amplia de alimentos, para el caso de este trabajo se hará uso de los boletines generados semanalmente.</p>
<p>Para la recolección de los boletines semanales se llevará a cabo una descarga directa de los boletines desde el portal del SIPSA en donde se encuentran los boletines publicados semanalmente desde 2012 hasta 2023, como se ha mencionado desde un inicio aqui se tomará como referencia el periodo 2016-2023 tomando como corte el mes de Junio del año en curso; el proceso de recolección de la información da como resultado múltiples archivos en formato excel (.xlsx) con diferentes formatos y disposiciones a nivel de la distribución de información, ante lo cual se hace necesario realizar un procesamiento de todos los archivos resultantes de tal manera que se logre una fuente consolidada con la cual sea mucho más sencillo trabajar.</p>
<p>El análisis detallado de los archivos descargados permite evidenciar que los boletines tienen algunos atributos particulares:</p>
<ul>
<li><p>La estructura de la tabla de los boletines no contiene explicitamente una fecha,el rango de fecha del archivo se encuentra en el nombre del fichero descargado, por ejemplo “Sem_2ene_8ene_2016.xls”.</p></li>
<li><p>La estructura de los boletines no es uniforme a través del tiempo, entre 2016 hasta el 11 de Mayo de 2018 la estructura de los boletines resulta ser más simple ya que el archivo no contiene paginación y cuenta con titulos intermedios para separar los grupos de alimentos. Desde el 11 de Mayo la estructura cambia a documentos de excel paginados por tipo de alimento involucrando inclusive hojas adicionales relacionadas a temas de disponibilidad por asuntos de cantidades ofrecidas en la central de abastos.</p></li>
<li><p>Para lograr un procesamiento eficiente es necesario realizar operaciones en ciclo para los archivos de tal forma que se logre llegar a un set de datos consolidado.</p></li>
</ul>
<p>A continuación se muestra un preview del aspecto de los sets de datos resultantes al leer un boletin tipo 1 y tipo 2:</p>
<ul>
<li>Ejemplo boletín tipo 1:</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb1-1" tabindex="-1"></a></span>
<span id="cb1-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb1-2" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb1-3" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np </span>
<span id="cb1-4"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb1-4" tabindex="-1"></a><span class="im">import</span> os </span>
<span id="cb1-5"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb1-5" tabindex="-1"></a><span class="im">import</span> openpyxl</span>
<span id="cb1-6"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb1-6" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt </span>
<span id="cb1-7"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb1-7" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-8"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb1-8" tabindex="-1"></a></span>
<span id="cb1-9"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb1-9" tabindex="-1"></a><span class="co">## En este caso vamos a leer un boletin de 2016</span></span>
<span id="cb1-10"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb1-10" tabindex="-1"></a></span>
<span id="cb1-11"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb1-11" tabindex="-1"></a>archivo <span class="op">=</span> pd.read_excel(<span class="st">&quot;C://Users//DAVID//Documents//SeriesDeTiempo_MCD2023//bookdown-seriesdetiempo_mcd//Bookdown_SeriesDeTiempo//Historico_Precios_SIPSA//2016//Sem_2ene_8ene_2016.xls&quot;</span>,skiprows<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb1-12"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb1-12" tabindex="-1"></a></span>
<span id="cb1-13"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb1-13" tabindex="-1"></a>archivo.info()</span></code></pre></div>
<pre><code>## &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
## RangeIndex: 4839 entries, 0 to 4838
## Data columns (total 5 columns):
##  #   Column                Non-Null Count  Dtype 
## ---  ------                --------------  ----- 
##  0   Productos y mercados  4839 non-null   object
##  1   Precio mínimo         4478 non-null   object
##  2   Precio máximo         4478 non-null   object
##  3   Precio medio          4478 non-null   object
##  4   Tendencia             4478 non-null   object
## dtypes: object(5)
## memory usage: 189.1+ KB</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb3-1" tabindex="-1"></a></span>
<span id="cb3-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb3-2" tabindex="-1"></a>archivo.head()</span></code></pre></div>
<pre><code>##            Productos y mercados Precio mínimo  ... Precio medio Tendencia
## 0                        Acelga           NaN  ...          NaN       NaN
## 1               Armenia, Mercar          1333  ...         1400         +
## 2  Barranquilla, Barranquillita          2800  ...         3000         =
## 3      Bogotá, D.C., Corabastos           500  ...          780         -
## 4    Bucaramanga, Centroabastos          1000  ...         1000        --
## 
## [5 rows x 5 columns]</code></pre>
<p>Como puede observarse esta primera versión de boletión solo cuenta con 5 columnas, particularmente este tipo de boletin mezcla en una misma columna los productos y los mercados, los productos aparecen una vez se han listado todos los mercados en los que están disponibles y se caracterizan por tener valores vacios en todas las columnas cuando su nombre aparece, seguidamente, como se mencionó no hay una fecha explicita por lo tanto es necesario usar la fecha que esta demarcada en el archivo para poder ubicar los datos en el tiempo.</p>
<ul>
<li>Ejemplo boletín tipo 2:</li>
</ul>
<p>Para la lectura de este boletín es necesario utilizar varios argumentos adicionales de la función pd.read_excel, de hecho para lograr una extracción completa de los datos es necesario llevar a cabo un ciclo for, no obstante en este caso solo veremos de manera general la estructura de una hoja y los argumentos que es necesario introducir:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb5-1" tabindex="-1"></a>archivo2<span class="op">=</span> pd.read_excel(<span class="st">&quot;C://Users//DAVID//Documents//SeriesDeTiempo_MCD2023//bookdown-seriesdetiempo_mcd//Bookdown_SeriesDeTiempo//Historico_Precios_SIPSA//2018//Boletin_Tipo2//Sem_01dic__07dic_2018.xlsx&quot;</span>,skiprows<span class="op">=</span><span class="dv">9</span>,sheet_name<span class="op">=</span><span class="dv">1</span>).dropna(axis<span class="op">=</span><span class="dv">1</span>,how<span class="op">=</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb5-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb5-3" tabindex="-1"></a>archivo2.info()</span></code></pre></div>
<pre><code>## &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
## RangeIndex: 945 entries, 0 to 944
## Data columns (total 6 columns):
##  #   Column             Non-Null Count  Dtype 
## ---  ------             --------------  ----- 
##  0   Producto           945 non-null    object
##  1   Mercado mayorista  945 non-null    object
##  2   Precio mínimo      945 non-null    int64 
##  3   Precio máximo      945 non-null    int64 
##  4   Precio medio       945 non-null    int64 
##  5   Tendencia          945 non-null    object
## dtypes: int64(3), object(3)
## memory usage: 44.4+ KB</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb7-1" tabindex="-1"></a>archivo2.head()</span></code></pre></div>
<pre><code>##   Producto             Mercado mayorista  ...  Precio medio  Tendencia
## 0   Acelga               Armenia, Mercar  ...          1022         --
## 1   Acelga  Barranquilla, Barranquillita  ...          3067          +
## 2   Acelga      Bogotá, D.C., Corabastos  ...           583          +
## 3   Acelga    Bucaramanga, Centroabastos  ...          1125         ++
## 4   Acelga         Chiquinquirá (Boyacá)  ...          1067          =
## 
## [5 rows x 6 columns]</code></pre>
<p>Se puede apreciar que a diferencia del boletin 1, este boletín separa el producto del mercado mayorista lo cual lo acerca a la estructura ideal del set de datos, no obstante la complejidad de este conjunto de información es que involucra multiples hojas por cada archivo procesado, y además cada hoja en ocasiones tiene ciertas particularidades.</p>
<p>Para facilitar el ejercicio, toda la labor de pre-procesamiento y limpieza inicial han sido realizadas previamente, en esta sección se explican las funciones diseñadas para llevar a cabo este proceso, las porciones de codigo aqui mostradas no son ejecutables simplemente son ilustrativas.</p>
<p>Los paquetes utilizados para llevar a cabo el procesamiento de los boletines han sido pandas, numpy y os.</p>
<div id="funciones-para-el-pre-procesamiento-y-limpieza-de-los-boletines-para-el-periodo-2016-a-11-de-mayo-de-2018" class="section level3 hasAnchor" number="2.0.1">
<h3><span class="header-section-number">2.0.1</span> Funciones para el pre-procesamiento y limpieza de los boletines para el periodo 2016 a 11 de Mayo de 2018<a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#funciones-para-el-pre-procesamiento-y-limpieza-de-los-boletines-para-el-periodo-2016-a-11-de-mayo-de-2018" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La primera función que se crea se denomina bolsipsatipo1_proc(ruta) el argumento de esta función es la ruta en la cual se encuentra el boletin a procesar, a continuación se muestra el codigo de la función:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb9-1" tabindex="-1"></a></span>
<span id="cb9-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb9-2" tabindex="-1"></a><span class="kw">def</span> bolsipsatipo1_proc(ruta):</span>
<span id="cb9-3"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb9-3" tabindex="-1"></a>    nombre<span class="op">=</span>os.path.split(ruta)[<span class="dv">1</span>].replace(<span class="st">&quot;.xlsx&quot;</span> <span class="kw">or</span> <span class="st">&quot;.xls&quot;</span>,<span class="st">&quot;&quot;</span>)</span>
<span id="cb9-4"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb9-4" tabindex="-1"></a>    boletin<span class="op">=</span> pd.read_excel(ruta,skiprows<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb9-5"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb9-5" tabindex="-1"></a>    boletin[<span class="st">&quot;periodo&quot;</span>]<span class="op">=</span>nombre</span>
<span id="cb9-6"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb9-6" tabindex="-1"></a>    boletin<span class="op">=</span> boletin[(boletin[<span class="st">&quot;Productos y mercados&quot;</span>].<span class="bu">str</span>.find(<span class="st">&quot;Cuadro&quot;</span>)<span class="op">==-</span><span class="dv">1</span>)<span class="op">\</span></span>
<span id="cb9-7"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb9-7" tabindex="-1"></a>                     <span class="op">&amp;</span> (boletin[<span class="st">&quot;Productos y mercados&quot;</span>].<span class="bu">str</span>.find(<span class="st">&quot;Productos&quot;</span>)<span class="op">==-</span><span class="dv">1</span>)]</span>
<span id="cb9-8"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb9-8" tabindex="-1"></a>    boletin[<span class="st">&quot;Tendencia&quot;</span>]<span class="op">=</span>boletin[<span class="st">&quot;Tendencia&quot;</span>].fillna(<span class="st">&quot;Producto&quot;</span>)</span>
<span id="cb9-9"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb9-9" tabindex="-1"></a>    boletin[<span class="st">&quot;Producto&quot;</span>]<span class="op">=</span>np.nan </span>
<span id="cb9-10"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb9-10" tabindex="-1"></a>    </span>
<span id="cb9-11"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb9-11" tabindex="-1"></a>    producto<span class="op">=</span><span class="va">None</span></span>
<span id="cb9-12"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb9-12" tabindex="-1"></a>    </span>
<span id="cb9-13"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb9-13" tabindex="-1"></a>    <span class="cf">for</span> index <span class="kw">in</span> boletin.index:</span>
<span id="cb9-14"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb9-14" tabindex="-1"></a>        <span class="cf">if</span> boletin.loc[index,<span class="st">&quot;Tendencia&quot;</span>]<span class="op">==</span><span class="st">&quot;Producto&quot;</span>:</span>
<span id="cb9-15"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb9-15" tabindex="-1"></a>            producto<span class="op">=</span>boletin.loc[index,<span class="st">&quot;Productos y mercados&quot;</span>]</span>
<span id="cb9-16"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb9-16" tabindex="-1"></a>            boletin.loc[index,<span class="st">&quot;Producto&quot;</span>]<span class="op">=</span> producto</span>
<span id="cb9-17"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb9-17" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb9-18"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb9-18" tabindex="-1"></a>            boletin.loc[index,<span class="st">&quot;Producto&quot;</span>]<span class="op">=</span> producto</span>
<span id="cb9-19"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb9-19" tabindex="-1"></a>    </span>
<span id="cb9-20"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb9-20" tabindex="-1"></a>    boletin<span class="op">=</span> boletin[(boletin[<span class="st">&quot;Tendencia&quot;</span>]<span class="op">!=</span><span class="st">&quot;Producto&quot;</span>)] </span>
<span id="cb9-21"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb9-21" tabindex="-1"></a>    boletin<span class="op">=</span> boletin.rename(columns<span class="op">=</span>{<span class="st">&quot;Productos y mercados&quot;</span>:<span class="st">&quot;Mercado mayorista&quot;</span>})</span>
<span id="cb9-22"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb9-22" tabindex="-1"></a>    </span>
<span id="cb9-23"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb9-23" tabindex="-1"></a>    <span class="cf">return</span> boletin </span></code></pre></div>
<p>Esta primera función inicialmente captura el nombre del archivo removiendo la extensión, posteriormente realiza una lectura del archivo que hay en la ruta omitiendo la lectura de la primera fila y adicionalmente crea una columna denominada periodo en donde se coloca el nombre extraido del archivo que esta siendo procesado, seguidamente omite las filas que contengan los strings “Cuadro” y “Producto” creando una columna denominada tendencia en donde copia el contenido de la columna y lo rellena con la palabra “Producto” en los espacios en blanco, finalmente se crea una columna denominada producto con valores “nan” la finalidad de esta columna es lograr separar el nombre del mercado mayorista del producto.</p>
<p>Para lograr separar el nombre del producto de la columna “Productos y mercados” se recorre el dataset y se pone el nombre del producto cada vez que aparece el nombre “Productos y mercados” a partir de esto se comienza a poblar la columna producto en donde queda aislado el nombre del producto; finalmente se eliminan las columnas que quedaron con el nombre “Producto” y se renombra la columna “Productos y mercados” y pasa a llamarse “Mercado mayorista”, finalmente la función devuelve un dataframe denominado “boletin”.</p>
<p>Esta primera función representa el procesamiento de una ruta que haga referencia a un archivo, no obstante para lograr un procesamiento en serie es relevante lograr un procesamiento “por carpeta” que permita procesar directamente los archivos por año, para logra esto se crea la función proc_carpetassipsat1(ruta_carpeta) cuyo argumento es la ruta a una carpeta en particular, el código de la función es el siguiente:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb10-1" tabindex="-1"></a></span>
<span id="cb10-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb10-2" tabindex="-1"></a><span class="kw">def</span> proc_carpetassipsat1(ruta_carpeta):</span>
<span id="cb10-3"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb10-3" tabindex="-1"></a>    ficheros<span class="op">=</span>os.listdir(ruta_carpeta)</span>
<span id="cb10-4"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb10-4" tabindex="-1"></a>    lista_rutas<span class="op">=</span>[]</span>
<span id="cb10-5"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb10-5" tabindex="-1"></a>    ruta_entera<span class="op">=</span><span class="va">None</span></span>
<span id="cb10-6"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb10-6" tabindex="-1"></a>    </span>
<span id="cb10-7"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb10-7" tabindex="-1"></a>    <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> ficheros:</span>
<span id="cb10-8"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb10-8" tabindex="-1"></a>        ruta_entera<span class="op">=</span> ruta_carpeta<span class="op">+</span><span class="st">&quot;</span><span class="ch">\\</span><span class="st">&quot;</span><span class="op">+</span><span class="bu">file</span></span>
<span id="cb10-9"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb10-9" tabindex="-1"></a>        lista_rutas.append(ruta_entera)</span>
<span id="cb10-10"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb10-10" tabindex="-1"></a>    </span>
<span id="cb10-11"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb10-11" tabindex="-1"></a>    lista_dataframes<span class="op">=</span>[]</span>
<span id="cb10-12"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb10-12" tabindex="-1"></a>    </span>
<span id="cb10-13"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb10-13" tabindex="-1"></a>    <span class="cf">for</span> ruta <span class="kw">in</span> lista_rutas:</span>
<span id="cb10-14"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb10-14" tabindex="-1"></a>        <span class="bu">print</span>(ruta)</span>
<span id="cb10-15"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb10-15" tabindex="-1"></a>        boletin_procesado<span class="op">=</span>bolsipsatipo1_proc(ruta)</span>
<span id="cb10-16"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb10-16" tabindex="-1"></a>        lista_dataframes.append(boletin_procesado)</span>
<span id="cb10-17"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb10-17" tabindex="-1"></a>        boletin_consolidado<span class="op">=</span> pd.concat(lista_dataframes)</span>
<span id="cb10-18"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb10-18" tabindex="-1"></a>        </span>
<span id="cb10-19"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb10-19" tabindex="-1"></a>    <span class="cf">return</span> boletin_consolidado</span></code></pre></div>
<p>La función anterior toma la ruta de una carpeta y partir del paquete “os” genera una lista de los archivos que hay dentro de la misma, asi mismo, al inicio se crea una lista vacia de rutas y una variable denominada ruta_entera que servirá para almacenar la ruta completa de cada archivo individual que hay en la carpeta, una vez hecho esto un ciclo for recorre la lista de ficheros que hay en la carpeta y por medio de esta crea la ruta de cada archivo que es almacenada en la variable “lista_rutas” que finalmente contendrá la ruta individual de cada archivo.</p>
<p>Una vez se ejecuta el primer ciclo for se declara la variable lista_dataframes que almacenerá cada uno de los boletines procesados; una vez declarada la variable antes mencionada inicia un nuevo ciclo for que recorre “lista_rutas” en donde a cada archivo individual se le aplica la función bolsipsatipo1_proc() y cada dataframe resultante se almacena en la lista “lista_dataframes” que luego es concatenada dando lugar a un dataframe consolidado para los reportes que reposaban en la carpeta.<br />
Finalmente para optimizar aun más el procesamiento se crea la función procesamiento_carpetas_bolSIPSAT1(lista_carpetas) que tiene como argumento una lista de rutas de carpetas, la finalidad de esta función es usar de manera simultanea las funciones anteriormente creadas y acelerar el procesamiento de los archivos buscando la consolidación automatica de varios años de información ahorrando repetición de lineas de código, la función desarrollada es la siguiente:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb11-1" tabindex="-1"></a></span>
<span id="cb11-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb11-2" tabindex="-1"></a><span class="kw">def</span> procesamiento_carpetas_bolSIPSAT1(lista_carpetas):</span>
<span id="cb11-3"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb11-3" tabindex="-1"></a>    </span>
<span id="cb11-4"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb11-4" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">type</span>(lista_carpetas) <span class="kw">is</span> <span class="bu">list</span>:</span>
<span id="cb11-5"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb11-5" tabindex="-1"></a>        lista_consolidados<span class="op">=</span> []</span>
<span id="cb11-6"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb11-6" tabindex="-1"></a>        <span class="cf">for</span> carpeta <span class="kw">in</span> lista_carpetas:</span>
<span id="cb11-7"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb11-7" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;se esta procesando la carpeta de boletines tipo 1: &quot;</span>,carpeta)</span>
<span id="cb11-8"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb11-8" tabindex="-1"></a>            consolidado<span class="op">=</span> proc_carpetassipsat1(carpeta)</span>
<span id="cb11-9"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb11-9" tabindex="-1"></a>            lista_consolidados.append(consolidado)</span>
<span id="cb11-10"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb11-10" tabindex="-1"></a>            consolidado_carpetas_entrada<span class="op">=</span> pd.concat(lista_consolidados)</span>
<span id="cb11-11"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb11-11" tabindex="-1"></a>        </span>
<span id="cb11-12"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb11-12" tabindex="-1"></a>        <span class="cf">return</span> consolidado_carpetas_entrada</span>
<span id="cb11-13"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb11-13" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb11-14"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb11-14" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">TypeError</span>(<span class="st">&quot;Only list objects are accepted as input&quot;</span>)</span></code></pre></div>
<p>Esta función toma una lista de carpetas con boletines del SIPSA y por medio de un ciclo for aplica a cada una de las carpetas la función proc_carpetassipsat1(carpeta) a través de la aplicación de esta función de manera iterativa genera una lista de dataframes de boletines semanales consolidados por año y luego une todos los años procesados en un solo dataframe.</p>
<p>Las funciones descritas en esta sección permiten hacer un procesamiento en serie de los boletines tipo 1, a continuación veremos las funciones desarrolladas para el tratamiento de los bolestines tipo 2.</p>
</div>
<div id="funciones-para-el-pre-procesamiento-y-limpieza-de-los-boletines-para-el-periodo-de-mayo-de-2018-a-diciembre-de-2022" class="section level3 hasAnchor" number="2.0.2">
<h3><span class="header-section-number">2.0.2</span> Funciones para el pre-procesamiento y limpieza de los boletines para el periodo de Mayo de 2018 a Diciembre de 2022<a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#funciones-para-el-pre-procesamiento-y-limpieza-de-los-boletines-para-el-periodo-de-mayo-de-2018-a-diciembre-de-2022" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Como se mencionó con anterioridad los boletines tipo II tienen un grado mayor de complejidad al tratarse de documentos de excel paginados, en medio de esto hay una mayor cantidad de excepciones y casos a considerar que llevan a que las funciones de procesamiento sean mucho más robustas y complejas. Para este caso la dinámica de desarrollo de funciones es la misma, es decir, va de una función inicial para el procesamiento de cada boletín, luego una función para procesamiento a nivel de carpetas y finalmente una función para procesamiento de una lista de carpetas.</p>
<p>Veamos la función construida para la limpieza de cada boletín:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-1" tabindex="-1"></a></span>
<span id="cb12-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-2" tabindex="-1"></a><span class="kw">def</span> bolsipsatipo2_2018_proc(ruta):</span>
<span id="cb12-3"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-3" tabindex="-1"></a>    nombre<span class="op">=</span>os.path.split(ruta)[<span class="dv">1</span>].replace(<span class="st">&quot;.xlsx&quot;</span> <span class="kw">or</span> <span class="st">&quot;.xls&quot;</span>,<span class="st">&quot;&quot;</span>)</span>
<span id="cb12-4"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-4" tabindex="-1"></a>    </span>
<span id="cb12-5"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-5" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">&quot;Sem_12may__18may_2018_int&quot;</span> <span class="kw">in</span> nombre:</span>
<span id="cb12-6"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-6" tabindex="-1"></a>        boletin<span class="op">=</span> pd.read_excel(ruta,sheet_name<span class="op">=</span><span class="va">None</span>,usecols<span class="op">=</span><span class="st">&quot;B:G&quot;</span>)</span>
<span id="cb12-7"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-7" tabindex="-1"></a>        boletin<span class="op">=</span> {key:val <span class="cf">for</span> key,val <span class="kw">in</span> boletin.items() <span class="cf">if</span> <span class="kw">not</span> key.endswith(<span class="st">&quot;ce&quot;</span>)}</span>
<span id="cb12-8"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-8" tabindex="-1"></a>        lista_df<span class="op">=</span>[]</span>
<span id="cb12-9"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-9" tabindex="-1"></a>        </span>
<span id="cb12-10"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-10" tabindex="-1"></a>        <span class="cf">for</span> hoja,tabla <span class="kw">in</span> boletin.items():</span>
<span id="cb12-11"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-11" tabindex="-1"></a>            tabla<span class="op">=</span>tabla.dropna(axis<span class="op">=</span><span class="dv">1</span>,how<span class="op">=</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb12-12"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-12" tabindex="-1"></a>            lista_df.append(tabla)</span>
<span id="cb12-13"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-13" tabindex="-1"></a>            df_consolidado<span class="op">=</span>pd.concat(lista_df)</span>
<span id="cb12-14"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-14" tabindex="-1"></a>            df_consolidado[<span class="st">&quot;periodo&quot;</span>]<span class="op">=</span>nombre</span>
<span id="cb12-15"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-15" tabindex="-1"></a>            <span class="bu">print</span>(df_consolidado.columns)</span>
<span id="cb12-16"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-16" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb12-17"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-17" tabindex="-1"></a>        boletin<span class="op">=</span> pd.read_excel(ruta,skiprows<span class="op">=</span><span class="dv">9</span>,sheet_name<span class="op">=</span><span class="va">None</span>,usecols<span class="op">=</span><span class="st">&quot;A:F&quot;</span>)</span>
<span id="cb12-18"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-18" tabindex="-1"></a>        boletin<span class="op">=</span> {key:val <span class="cf">for</span> key,val <span class="kw">in</span> boletin.items() <span class="cf">if</span> <span class="kw">not</span> key.endswith(<span class="st">&quot;ce&quot;</span>)}</span>
<span id="cb12-19"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-19" tabindex="-1"></a>    </span>
<span id="cb12-20"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-20" tabindex="-1"></a>        lista_df<span class="op">=</span>[]</span>
<span id="cb12-21"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-21" tabindex="-1"></a>    </span>
<span id="cb12-22"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-22" tabindex="-1"></a>        <span class="cf">for</span> hoja,tabla <span class="kw">in</span> boletin.items():</span>
<span id="cb12-23"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-23" tabindex="-1"></a>            tabla<span class="op">=</span>tabla.dropna(axis<span class="op">=</span><span class="dv">1</span>,how<span class="op">=</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb12-24"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-24" tabindex="-1"></a>            lista_columnas<span class="op">=</span>tabla.columns</span>
<span id="cb12-25"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-25" tabindex="-1"></a>            <span class="bu">print</span>(lista_columnas,nombre)</span>
<span id="cb12-26"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-26" tabindex="-1"></a>            </span>
<span id="cb12-27"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-27" tabindex="-1"></a>            <span class="cf">if</span> (<span class="st">&#39;          Pesos por kilogramo&#39;</span> <span class="kw">in</span> lista_columnas) <span class="kw">or</span><span class="op">\</span></span>
<span id="cb12-28"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-28" tabindex="-1"></a>            (<span class="st">&#39;          Pesos por kilogramo*&#39;</span> <span class="kw">in</span> lista_columnas):</span>
<span id="cb12-29"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-29" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;variacion de nombre de columnas - inicia modificación&quot;</span>)</span>
<span id="cb12-30"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-30" tabindex="-1"></a>                tabla.columns.values[<span class="dv">0</span>]<span class="op">=</span><span class="st">&#39;Producto&#39;</span></span>
<span id="cb12-31"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-31" tabindex="-1"></a>                tabla.columns.values[<span class="dv">1</span>]<span class="op">=</span><span class="st">&#39;Mercado mayorista&#39;</span></span>
<span id="cb12-32"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-32" tabindex="-1"></a>                tabla.columns.values[<span class="dv">2</span>]<span class="op">=</span><span class="st">&#39;Precio mínimo&#39;</span></span>
<span id="cb12-33"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-33" tabindex="-1"></a>                tabla.columns.values[<span class="dv">3</span>]<span class="op">=</span><span class="st">&#39;Precio máximo&#39;</span></span>
<span id="cb12-34"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-34" tabindex="-1"></a>                tabla.columns.values[<span class="dv">4</span>]<span class="op">=</span><span class="st">&#39;Precio medio&#39;</span></span>
<span id="cb12-35"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-35" tabindex="-1"></a>                tabla.columns.values[<span class="dv">5</span>]<span class="op">=</span><span class="st">&#39;Tendencia&#39;</span></span>
<span id="cb12-36"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-36" tabindex="-1"></a>                </span>
<span id="cb12-37"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-37" tabindex="-1"></a>                <span class="bu">print</span>(tabla.head(<span class="dv">1</span>))</span>
<span id="cb12-38"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-38" tabindex="-1"></a>                tabla<span class="op">=</span>tabla.drop(index<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb12-39"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-39" tabindex="-1"></a>                </span>
<span id="cb12-40"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-40" tabindex="-1"></a>                </span>
<span id="cb12-41"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-41" tabindex="-1"></a>                <span class="co">#print(tabla)</span></span>
<span id="cb12-42"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-42" tabindex="-1"></a>                </span>
<span id="cb12-43"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-43" tabindex="-1"></a>                lista_df.append(tabla)</span>
<span id="cb12-44"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-44" tabindex="-1"></a>                df_consolidado<span class="op">=</span>pd.concat(lista_df)</span>
<span id="cb12-45"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-45" tabindex="-1"></a>                df_consolidado[<span class="st">&quot;periodo&quot;</span>]<span class="op">=</span>nombre</span>
<span id="cb12-46"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-46" tabindex="-1"></a>                <span class="co">#print(df_consolidado.columns)   </span></span>
<span id="cb12-47"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-47" tabindex="-1"></a>                <span class="co">#print(df_consolidado)</span></span>
<span id="cb12-48"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-48" tabindex="-1"></a>                </span>
<span id="cb12-49"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-49" tabindex="-1"></a>            </span>
<span id="cb12-50"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-50" tabindex="-1"></a>            <span class="cf">elif</span> (<span class="st">&#39;GRUPO&#39;</span> <span class="kw">in</span> lista_columnas) <span class="kw">or</span> (<span class="st">&#39;TOTAL MERCADOS&#39;</span> <span class="kw">in</span> lista_columnas):</span>
<span id="cb12-51"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-51" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;sección de abastecimiento semanal innecesaria - se da paso a sección siguiente&quot;</span>)</span>
<span id="cb12-52"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-52" tabindex="-1"></a>                <span class="cf">pass</span></span>
<span id="cb12-53"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-53" tabindex="-1"></a>            </span>
<span id="cb12-54"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-54" tabindex="-1"></a>            </span>
<span id="cb12-55"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-55" tabindex="-1"></a>            <span class="cf">elif</span> lista_columnas[<span class="dv">5</span>]<span class="op">==</span><span class="st">&quot;Precio mínimo&quot;</span>:</span>
<span id="cb12-56"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-56" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;sección de arroz en molino innecesaria - se da paso a sección siguiente&quot;</span>)</span>
<span id="cb12-57"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-57" tabindex="-1"></a>                <span class="cf">pass</span></span>
<span id="cb12-58"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-58" tabindex="-1"></a>            </span>
<span id="cb12-59"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-59" tabindex="-1"></a>            <span class="cf">elif</span> <span class="st">&#39;          Pesos por tonelada&#39;</span> <span class="kw">in</span> lista_columnas:</span>
<span id="cb12-60"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-60" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;sección de arroz en molino innecesaria - se da paso a sección siguiente&quot;</span>)</span>
<span id="cb12-61"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-61" tabindex="-1"></a>                <span class="cf">pass</span></span>
<span id="cb12-62"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-62" tabindex="-1"></a>            </span>
<span id="cb12-63"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-63" tabindex="-1"></a>              </span>
<span id="cb12-64"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-64" tabindex="-1"></a>            <span class="cf">elif</span> <span class="st">&#39;Unnamed: 1&#39;</span> <span class="kw">in</span> lista_columnas <span class="kw">and</span> tabla.shape[<span class="dv">0</span>]<span class="op">&gt;</span><span class="dv">100</span>:</span>
<span id="cb12-65"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-65" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;variacion de nombre de columnas por anomalia de fila adicional - inicia modificación&quot;</span>)</span>
<span id="cb12-66"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-66" tabindex="-1"></a>                tabla.columns.values[<span class="dv">0</span>]<span class="op">=</span><span class="st">&#39;Producto&#39;</span></span>
<span id="cb12-67"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-67" tabindex="-1"></a>                tabla.columns.values[<span class="dv">1</span>]<span class="op">=</span><span class="st">&#39;Mercado mayorista&#39;</span></span>
<span id="cb12-68"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-68" tabindex="-1"></a>                tabla.columns.values[<span class="dv">2</span>]<span class="op">=</span><span class="st">&#39;Precio mínimo&#39;</span></span>
<span id="cb12-69"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-69" tabindex="-1"></a>                tabla.columns.values[<span class="dv">3</span>]<span class="op">=</span><span class="st">&#39;Precio máximo&#39;</span></span>
<span id="cb12-70"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-70" tabindex="-1"></a>                tabla.columns.values[<span class="dv">4</span>]<span class="op">=</span><span class="st">&#39;Precio medio&#39;</span></span>
<span id="cb12-71"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-71" tabindex="-1"></a>                tabla.columns.values[<span class="dv">5</span>]<span class="op">=</span><span class="st">&#39;Tendencia&#39;</span></span>
<span id="cb12-72"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-72" tabindex="-1"></a>                </span>
<span id="cb12-73"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-73" tabindex="-1"></a>                <span class="bu">print</span>(tabla.head(<span class="dv">1</span>))</span>
<span id="cb12-74"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-74" tabindex="-1"></a>                tabla<span class="op">=</span>tabla.drop(index<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb12-75"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-75" tabindex="-1"></a>                </span>
<span id="cb12-76"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-76" tabindex="-1"></a>                </span>
<span id="cb12-77"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-77" tabindex="-1"></a>                <span class="bu">print</span>(tabla)</span>
<span id="cb12-78"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-78" tabindex="-1"></a>                </span>
<span id="cb12-79"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-79" tabindex="-1"></a>                lista_df.append(tabla)</span>
<span id="cb12-80"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-80" tabindex="-1"></a>                df_consolidado<span class="op">=</span>pd.concat(lista_df)</span>
<span id="cb12-81"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-81" tabindex="-1"></a>                df_consolidado[<span class="st">&quot;periodo&quot;</span>]<span class="op">=</span>nombre</span>
<span id="cb12-82"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-82" tabindex="-1"></a>                <span class="bu">print</span>(df_consolidado.columns)   </span>
<span id="cb12-83"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-83" tabindex="-1"></a>                <span class="bu">print</span>(df_consolidado)</span>
<span id="cb12-84"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-84" tabindex="-1"></a>         </span>
<span id="cb12-85"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-85" tabindex="-1"></a>                    </span>
<span id="cb12-86"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-86" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb12-87"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-87" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;sin variacion de nombre de columnas&quot;</span>)</span>
<span id="cb12-88"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-88" tabindex="-1"></a>                      </span>
<span id="cb12-89"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-89" tabindex="-1"></a>                lista_df.append(tabla)</span>
<span id="cb12-90"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-90" tabindex="-1"></a>                df_consolidado<span class="op">=</span>pd.concat(lista_df)</span>
<span id="cb12-91"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-91" tabindex="-1"></a>                df_consolidado[<span class="st">&quot;periodo&quot;</span>]<span class="op">=</span>nombre</span>
<span id="cb12-92"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-92" tabindex="-1"></a>                <span class="bu">print</span>(df_consolidado.columns)</span>
<span id="cb12-93"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-93" tabindex="-1"></a>            </span>
<span id="cb12-94"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb12-94" tabindex="-1"></a>    <span class="cf">return</span> df_consolidado</span></code></pre></div>
<p>La función anterior realiza tareas similares a la función para boletín tipo 1, no obstante esta considera varios escenarios condicionales, de manera general la función recorre el diccionario resultante de la lectura del archivo de excel en medio de este proceso se excluye la hoja de “Indice” para procesar unicamente hojas que contengan datos, una vez hecho esto se realizan transformaciones orientadas a tener un dataset uniforme que permita una armonización con el tipo de dataset generado en el caso de los boletines tipo 1, algunas de las condiciones que maneja la función son las siguientes:</p>
<ul>
<li><p>Si el fichero corresponde al boletin Sem_12may__18may_2018_int se ejecuta un procesamiento normal recorriendo las hojas del docuemento excel y generando un dataset consolidado.</p></li>
<li><p>En caso de no pertenecer al caso anterior se procede a leer el excel y cada una de sus hojas pero se generan varios casos de procesamiento según los elementos que se encuentren en las columnas:</p>
<ul>
<li><p>Si en las columnas aparece una columna llamada “Pesos por kilogramo” se procede a renombrar las columnas del set de datos.</p></li>
<li><p>Si en las columnas aparece “GRUPO” o “TOTAL MERCADOS” se omite el procesamiento de la hoja.</p></li>
<li><p>Si en la columna 6 del set de datos aparece el nombre “Precio minimo” o “Pesos por tonelada” tambien se procede a omitir el procesamiento de la hoja del libro de excel.<br />
</p></li>
<li><p>Si aparece el nombre de columna “Unnamed: 1” signifca que hay una fila adicional que impide que las variables queden debidamente nombradas, en este caso tambien se renombran las columnas.</p></li>
</ul></li>
<li><p>Si no presenta ninguno de los casos anteriores se realiza un procesamiento normal de la hoja y se procede a añadir el dataframe resultante al consolidado del boletin.</p></li>
</ul>
<p>La aplicación de la función da como resultado un dataframe consolidado en donde se encuentra toda la información de las hojas del boletin procesadas.</p>
<p>Ahora veamos la función que procesa en serie varios boletines contenidos en una carpeta:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-1" tabindex="-1"></a></span>
<span id="cb13-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-2" tabindex="-1"></a><span class="kw">def</span> proc_carpetassipsat2(ruta_carpeta):</span>
<span id="cb13-3"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-3" tabindex="-1"></a>    ficheros<span class="op">=</span>os.listdir(ruta_carpeta)</span>
<span id="cb13-4"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-4" tabindex="-1"></a>    lista_rutas<span class="op">=</span>[]</span>
<span id="cb13-5"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-5" tabindex="-1"></a>    ruta_entera<span class="op">=</span><span class="va">None</span></span>
<span id="cb13-6"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-6" tabindex="-1"></a>    </span>
<span id="cb13-7"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-7" tabindex="-1"></a>    <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> ficheros:</span>
<span id="cb13-8"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-8" tabindex="-1"></a>        ruta_entera<span class="op">=</span> ruta_carpeta<span class="op">+</span><span class="st">&quot;</span><span class="ch">\\</span><span class="st">&quot;</span><span class="op">+</span><span class="bu">file</span></span>
<span id="cb13-9"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-9" tabindex="-1"></a>        lista_rutas.append(ruta_entera)</span>
<span id="cb13-10"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-10" tabindex="-1"></a>    </span>
<span id="cb13-11"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-11" tabindex="-1"></a>    lista_dataframes<span class="op">=</span>[]</span>
<span id="cb13-12"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-12" tabindex="-1"></a>    </span>
<span id="cb13-13"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-13" tabindex="-1"></a>    <span class="cf">for</span> ruta <span class="kw">in</span> lista_rutas:</span>
<span id="cb13-14"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-14" tabindex="-1"></a>        <span class="bu">print</span>(ruta)</span>
<span id="cb13-15"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-15" tabindex="-1"></a>        boletin_procesado<span class="op">=</span>bolsipsatipo2_2018_proc(ruta)</span>
<span id="cb13-16"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-16" tabindex="-1"></a>        lista_dataframes.append(boletin_procesado)</span>
<span id="cb13-17"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-17" tabindex="-1"></a>        boletin_consolidado<span class="op">=</span> pd.concat(lista_dataframes)</span>
<span id="cb13-18"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-18" tabindex="-1"></a>        </span>
<span id="cb13-19"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-19" tabindex="-1"></a>    boletin_consolidado<span class="op">=</span> boletin_consolidado.reindex(columns<span class="op">=</span>[<span class="st">&quot;Mercado mayorista&quot;</span>,<span class="st">&quot;Precio mínimo&quot;</span>,<span class="st">&quot;Precio máximo&quot;</span>,<span class="st">&quot;Precio medio&quot;</span>,</span>
<span id="cb13-20"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-20" tabindex="-1"></a>                                                              <span class="st">&quot;Tendencia&quot;</span>,<span class="st">&quot;periodo&quot;</span>,<span class="st">&quot;Producto&quot;</span>])</span>
<span id="cb13-21"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-21" tabindex="-1"></a>    boletin_consolidado<span class="op">=</span> boletin_consolidado[boletin_consolidado[<span class="st">&quot;Producto&quot;</span>].isin([<span class="st">&quot;Menor a -20,01%              ---&quot;</span>,</span>
<span id="cb13-22"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-22" tabindex="-1"></a>                                                                                   <span class="st">&quot;Entre -10,01% y -20%       --&quot;</span>,</span>
<span id="cb13-23"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-23" tabindex="-1"></a>                                                                                   <span class="st">&quot;Entre - 0,01% y -10%        -&quot;</span>,</span>
<span id="cb13-24"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-24" tabindex="-1"></a>                                                                                   <span class="st">&quot;Variacion igual a 0%         =&quot;</span>,</span>
<span id="cb13-25"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-25" tabindex="-1"></a>                                                                                   <span class="st">&quot;Entre 0,01% y 10%             +&quot;</span>,</span>
<span id="cb13-26"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-26" tabindex="-1"></a>                                                                                   <span class="st">&quot;Entre 10,01% y 20%           ++&quot;</span>,</span>
<span id="cb13-27"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-27" tabindex="-1"></a>                                                                                   <span class="st">&quot;Mayor a 20,01%                 +++&quot;</span>,</span>
<span id="cb13-28"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-28" tabindex="-1"></a>                                                                                   <span class="st">&quot;n.d: no disponible&quot;</span>,</span>
<span id="cb13-29"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-29" tabindex="-1"></a>                                                                                    <span class="st">&quot;Tendencia*&quot;</span>])<span class="op">==</span><span class="va">False</span>]</span>
<span id="cb13-30"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-30" tabindex="-1"></a>    </span>
<span id="cb13-31"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-31" tabindex="-1"></a>    boletin_consolidado<span class="op">=</span> boletin_consolidado[boletin_consolidado[<span class="st">&quot;Producto&quot;</span>].<span class="bu">str</span>.find(<span class="st">&quot;precios&quot;</span>)<span class="op">==-</span><span class="dv">1</span>]</span>
<span id="cb13-32"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-32" tabindex="-1"></a>        </span>
<span id="cb13-33"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb13-33" tabindex="-1"></a>    <span class="cf">return</span> boletin_consolidado</span></code></pre></div>
<p>Esta función cumple el mismo ciclo de procesamiento que en el caso del boletín 1, no obstante presenta como excepción el hecho de que filtra o elimina algunas filas que contienen información relacionada a las “convenciones de tendencia” que tiene el boletín del SIPSA, finalmente esta función recorre los ficheros de los carpeta, genera una lista de rutas, usa la función para el procesamiento de boletines tipo 2 y concatena los dataframes resultantes en un solo dataframe.</p>
<p>Finalmente veamos la función para el procesamiento de un listado de carpetas:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb14-1" tabindex="-1"></a></span>
<span id="cb14-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb14-2" tabindex="-1"></a><span class="kw">def</span> procesamiento_carpetas_bolSIPSAT2(lista_carpetas):</span>
<span id="cb14-3"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb14-3" tabindex="-1"></a>    </span>
<span id="cb14-4"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb14-4" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">type</span>(lista_carpetas) <span class="kw">is</span> <span class="bu">list</span>:</span>
<span id="cb14-5"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb14-5" tabindex="-1"></a>        lista_consolidados<span class="op">=</span> []</span>
<span id="cb14-6"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb14-6" tabindex="-1"></a>        <span class="cf">for</span> carpeta <span class="kw">in</span> lista_carpetas:</span>
<span id="cb14-7"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb14-7" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;se esta procesando la carpeta de boletines tipo 2: &quot;</span>,carpeta)</span>
<span id="cb14-8"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb14-8" tabindex="-1"></a>            consolidado<span class="op">=</span> proc_carpetassipsat2(carpeta)</span>
<span id="cb14-9"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb14-9" tabindex="-1"></a>            lista_consolidados.append(consolidado)</span>
<span id="cb14-10"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb14-10" tabindex="-1"></a>            consolidado_carpetas_entrada<span class="op">=</span> pd.concat(lista_consolidados)</span>
<span id="cb14-11"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb14-11" tabindex="-1"></a>        </span>
<span id="cb14-12"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb14-12" tabindex="-1"></a>        <span class="cf">return</span> consolidado_carpetas_entrada</span>
<span id="cb14-13"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb14-13" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb14-14"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb14-14" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">TypeError</span>(<span class="st">&quot;Only list objects are accepted as input&quot;</span>)</span>
<span id="cb14-15"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb14-15" tabindex="-1"></a> </span></code></pre></div>
<p>Esta función en términos de pasos de procesamiento no tiene grandes diferencias al proceso realizado para boletines tipo 1, la única variación que presenta es el uso de las funciones especificas para este tipo de boletín.</p>
<p>El uso de los conjuntos de funciones mencionados en cada carpeta en donde se alojan los boletines descargados del SIPSA dan lugar a dos sets de datos consolidados que luego se concatenan para dar lugar a un conjunto de datos que consolida los boletines desde 2016 hasta 2022.</p>
<p>El conjunto de datos consolidado final se denomina “SIPSA_2016to2022.csv” y contiene las siguientes columnas:</p>
<ul>
<li>Mercado mayorista</li>
<li>Precio mínimo</li>
<li>Precio máximo</li>
<li>Precio medio</li>
<li>Tendencia</li>
<li>periodo</li>
<li>Producto</li>
</ul>
</div>
<div id="limpieza-de-set-de-datos-consolidado-de-boletines-sipsa-2016-a-2022" class="section level3 hasAnchor" number="2.0.3">
<h3><span class="header-section-number">2.0.3</span> Limpieza de set de datos consolidado de boletines SIPSA 2016 a 2022<a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#limpieza-de-set-de-datos-consolidado-de-boletines-sipsa-2016-a-2022" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para este proceso de limpieza se hace uso del set de datos “SIPSA_2016to2022.csv” que es el resultado del procesamiento previo realizado con las funciones explicadas en la sección anterior del documento, la limpieza de este dataset comprende la eliminación de registros inusuales producto de la consolidación, y tiene como objetivo principal normalizar las fechas, es decir, poder pasar las mismas de un “nombre de archivo” a una fecha que sea efectivamente manejable y permita un proceso posterior exitoso a nivel de análisis.</p>
<p>Como primer paso se cargan algunas librerias y el dataset que se almacenará en la variable “df_sipsa” :</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb15-1" tabindex="-1"></a></span>
<span id="cb15-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb15-2" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, timedelta</span>
<span id="cb15-3"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb15-3" tabindex="-1"></a><span class="im">import</span> re </span>
<span id="cb15-4"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb15-4" tabindex="-1"></a></span>
<span id="cb15-5"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb15-5" tabindex="-1"></a>df_sipsa<span class="op">=</span> pd.read_csv(<span class="st">&quot;C://Users//DAVID//Documents//SeriesDeTiempo_MCD2023//bookdown-seriesdetiempo_mcd//Bookdown_SeriesDeTiempo//FuenteConsolidadaSIPSA//SIPSA_2016to2022.csv&quot;</span>,sep<span class="op">=</span><span class="st">&quot;|&quot;</span>,low_memory<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-6"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb15-6" tabindex="-1"></a>df_sipsa.drop(columns<span class="op">=</span>{<span class="st">&quot;Unnamed: 0&quot;</span>},inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-7"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb15-7" tabindex="-1"></a></span>
<span id="cb15-8"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb15-8" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;El set de datos cuenta con </span><span class="sc">{</span>df_sipsa<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> registros y </span><span class="sc">{</span>df_sipsa<span class="sc">.</span>shape[<span class="dv">1</span>]<span class="sc">}</span><span class="ss"> columnas </span><span class="ch">\n</span><span class="ss">&quot;</span>)</span></code></pre></div>
<pre><code>## El set de datos cuenta con 1658625 registros y 7 columnas</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb17-1" tabindex="-1"></a>df_sipsa.head()</span></code></pre></div>
<pre><code>##               Mercado mayorista  ... Producto
## 0               Armenia, Mercar  ...   Acelga
## 1  Barranquilla, Barranquillita  ...   Acelga
## 2      Bogotá, D.C., Corabastos  ...   Acelga
## 3    Bucaramanga, Centroabastos  ...   Acelga
## 4         Chiquinquirá (Boyacá)  ...   Acelga
## 
## [5 rows x 7 columns]</code></pre>
<p>Como se puede apreciar el set de datos consolidado producto del procesamiento contiene más de un millón de registros y cuenta con las columnas que se habian mencionado al final de la sección anterior, la información aqui consolidada cuenta con información de 140 mercados mayoristas correspondientes a varios municipios del pais, y información relacionada a 672 productos en diversas frecuencias y disponibilidades según la central de abastos.</p>
<p>Para iniciar este proceso de limpieza primero se procederá a limpiar registros inusuales en las columnas diferentes a “Periodo, para facilitar este proceso se hará uso del método unique() con el fin de conocer los registros únicos que hay en cada columna y a partir de esto determinar que debe eliminarse u omitirse en caso de ser necesario.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb19-1" tabindex="-1"></a></span>
<span id="cb19-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb19-2" tabindex="-1"></a>df_sipsa[<span class="st">&quot;Mercado mayorista&quot;</span>].unique()</span></code></pre></div>
<pre><code>## array([&#39;Armenia, Mercar&#39;, &#39;Barranquilla, Barranquillita&#39;,
##        &#39;Bogotá, D.C., Corabastos&#39;, &#39;Bucaramanga, Centroabastos&#39;,
##        &#39;Chiquinquirá (Boyacá)&#39;, &#39;Duitama (Boyacá)&#39;, &#39;Florencia (Caquetá)&#39;,
##        &#39;Ibagué, Plaza La 21&#39;, &#39;Ipiales (Nariño), Ipiales somos todos&#39;,
##        &#39;Medellín, Central Mayorista de Antioquia&#39;, &#39;Neiva, Surabastos&#39;,
##        &#39;Pamplona (Norte de Santander)&#39;, &#39;Pasto, El Potrerillo&#39;,
##        &#39;Sogamoso (Boyacá)&#39;, &#39;Tunja, Complejo de Servicios del Sur&#39;,
##        &#39;Ubaté (Cundinamarca)&#39;, &#39;Villavicencio, CAV&#39;, &#39;Yopal (Casanare)&#39;,
##        &#39;Arauca (Arauca)&#39;, &#39;Barranquilla, Granabastos&#39;,
##        &#39;Buenaventura (Valle del Cauca)&#39;, &#39;Cali, Cavasa&#39;,
##        &#39;Cali, Santa Helena&#39;, &#39;Cartagena, Bazurto&#39;,
##        &#39;Cartago (Valle del Cauca)&#39;, &#39;Cúcuta, Cenabastos&#39;,
##        &#39;Manizales (Caldas)&#39;, &#39;Montería (Córdoba)&#39;,
##        &#39;Palmira (Valle del Cauca)&#39;, &#39;Pereira, La 41&#39;, &#39;Pereira, Mercasa&#39;,
##        &#39;Popayán (Cauca)&#39;, &#39;Rionegro (Antioquia)&#39;, &#39;San Gil (Santander)&#39;,
##        &#39;Santa Marta (Magdalena)&#39;, &#39;Sincelejo (Sucre)&#39;,
##        &#39;Socorro (Santander)&#39;, &#39;Tuluá (Valle del Cauca)&#39;,
##        &#39;Valledupar, Mercabastos&#39;, &#39;Valledupar, Mercado Nuevo&#39;,
##        &#39;Túquerres (Nariño)&#39;, &#39;San Andrés de Tumaco (Nariño)&#39;,
##        &#39;Marinilla (Antioquia)&#39;,
##        &#39;Medellín, Plaza Minorista &quot;José María Villa&quot;&#39;,
##        &#39;El Carmen de Viboral (Antioquia)&#39;, &#39;El Santuario (Antioquia)&#39;,
##        &#39;La Ceja (Antioquia)&#39;, &#39;San Vicente (Antioquia)&#39;,
##        &#39;Sonsón (Antioquia)&#39;, &#39;La Unión (Nariño)&#39;, &#39;Armenia, Retiro&#39;,
##        &#39;Peñol (Antioquia)&#39;, &#39;Santa Bárbara (Antioquia)&#39;,
##        &#39;Cúcuta, La Nueva Sexta&#39;, &#39;Bucaramanga, Mercados del centro&#39;,
##        &#39;Ipiales (Nariño), Centro de acopio&#39;, &#39;La Unión (Antioquia)&#39;,
##        &#39;Bogotá, D.C., Paloquemao&#39;, &#39;Bogotá, D.C., Plaza España&#39;,
##        &#39;Cali, La Floresta&#39;, &#39;Cali, Siloé&#39;,
##        &#39;Bogotá, D.C., Plaza Las Flores&#39;, &#39;Cali, Galeria Alameda&#39;,
##        &#39;Bogotá, D.C., Frigorífico Ble Ltda.&#39;,
##        &#39;Bogotá, D.C., Frigorífico Guadalupe&#39;, &#39;Bucaramanga, Frigoríficos&#39;,
##        &#39;Armenia, Frigocafé&#39;, &#39;Malambo (Atlántico), Carnes y carnes&#39;,
##        &#39;Ibagué, Frigorífico Carlima&#39;, &#39;Montería, Frigosinú&#39;,
##        &#39;Charalá (Santander)&#39;, &#39;Güepsa (Santander)&#39;, &#39;Moniquirá (Boyacá)&#39;,
##        &#39;San Gil (Santander), panela&#39;, &#39;Santana (Boyacá)&#39;,
##        &#39;Vélez (Santander)&#39;, &#39;Ancuyá (Nariño)&#39;, &#39;Caparrapí (Cundinamarca)&#39;,
##        &#39;Consacá (Nariño)&#39;, &#39;Nocaima (Cundinamarca)&#39;, &#39;Sandoná (Nariño)&#39;,
##        &#39;Villeta (Cundinamarca)&#39;, &#39;Yolombó (Antioquia)&#39;, &#39;Pasto (Nariño)&#39;,
##        &#39;Tunja (Boyacá)&#39;, &#39;San Marcos, Arrocera Formosa&#39;,
##        &#39;Ancuya (Nariño)&#39;, &#39;Producto&#39;, &#39;Pasto (Nariño), El Potrerillo&#39;,
##        &#39;Cali, Galería Alameda&#39;, &#39;Manizales, Centro Galerías&#39;,
##        &#39;Montería, Mercado del Sur&#39;,
##        &#39;Popayán, Plaza de mercado del barrio Bolívar&#39;,
##        &#39;Sincelejo, Nuevo Mercado&#39;, &#39;San Gil (Santander) &#39;, nan,
##        &#39;Bogotá, D.C., Frigorífico Ble Ltda,&#39;,
##        &#39;Tibasosa (Boyacá), Coomproriente&#39;,
##        &#39;San Sebastián de Mariquita (Tolima)&#39;, &#39;Aguazul (Casanare)&#39;,
##        &#39;Alvarado (Tolima)&#39;, &#39;Bucaramanga (Santander)&#39;,
##        &#39;Campoalegre (Huila)&#39;, &#39;Cúcuta (Norte de Santander)&#39;,
##        &#39;Espinal (Tolima)&#39;, &#39;Granada (Meta)&#39;, &#39;Ibagué (Tolima)&#39;,
##        &#39;Lérida (Tolima)&#39;, &#39;Neiva (Huila)&#39;, &#39;Purificación (Tolima)&#39;,
##        &#39;Rivera (Huila)&#39;, &#39;Sahagún (Córdoba)&#39;, &#39;San Martín (Meta)&#39;,
##        &#39;Venadillo (Tolima)&#39;, &#39;Villanueva (Casanare)&#39;,
##        &#39;Villavicencio (Meta)&#39;, &#39;Acacías (Meta)&#39;,
##        &#39;Barranquilla (Atlántico)&#39;, &#39;Magangué (Bolívar)&#39;,
##        &#39;Planeta Rica (Córdoba)&#39;, &#39;San Bernardo del Viento (Córdoba)&#39;,
##        &#39;San Marcos (Sucre)&#39;, &#39;Valledupar (Cesar)&#39;, &#39;Cali, Santa Elena&#39;,
##        &#39;Popayán, Plaza de Mercado del Barrio Bolívar&#39;,
##        &#39;San Sebastián de Mariquita (Tolima), panela&#39;,
##        &#39;Duitama (Boyacá), Mercaplaza&#39;,
##        &#39;Ipiales (Nariño), Ipiales Somos Todos&#39;,
##        &#39;Bucaramanga, Mercados del Centro&#39;,
##        &#39;Ipiales (Nariño), Centro de Acopio&#39;, &#39;Malambo, Atlantico&#39;,
##        &#39;San Gil (Santander), Panela&#39;, &#39;San Gil (Santander)panela&#39;,
##        &#39;Bogotá, D,C,, Corabastos&#39;, &#39;Bogotá, D,C,, Paloquemao&#39;,
##        &#39;Bogotá, D,C,, Plaza España&#39;, &#39;Bogotá, D,C,, Plaza Las Flores&#39;,
##        &#39;Bogotá, D,C,, Frigorífico Ble Ltda,&#39;,
##        &#39;Bogotá, D,C,, Frigorífico Guadalupe&#39;,
##        &#39;Malambo (Atlántico), Carnes y Carnes&#39;], dtype=object)</code></pre>
<p>Al revisar el listado de registros se puede apreciar que el contenido de la columna es consistente, todos los registros únicos disponibles corresponden a centrales de abasto, por lo tanto no es necesario en este caso realizar alguna operación de limpieza.</p>
<p>Ahora procedamos a revisar las columnas de “precio” con el fin de identificar si tienen algun inconveniente:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb21-1" tabindex="-1"></a></span>
<span id="cb21-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb21-2" tabindex="-1"></a>df_sipsa[<span class="st">&quot;Precio mínimo&quot;</span>].unique()</span></code></pre></div>
<pre><code>## array([&#39;1067&#39;, &#39;2400&#39;, &#39;800&#39;, ..., &#39;12627&#39;, &#39;13966&#39;, &#39;51994&#39;],
##       dtype=object)</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb23-1" tabindex="-1"></a>df_sipsa[<span class="st">&quot;Precio máximo&quot;</span>].unique()</span></code></pre></div>
<pre><code>## array([&#39;1200&#39;, &#39;2500&#39;, &#39;1000&#39;, ..., &#39;6318&#39;, &#39;14137&#39;, &#39;12637&#39;],
##       dtype=object)</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb25-1" tabindex="-1"></a>df_sipsa[<span class="st">&quot;Precio medio&quot;</span>].unique()</span></code></pre></div>
<pre><code>## array([&#39;1089&#39;, &#39;2458&#39;, &#39;957&#39;, ..., &#39;14032&#39;, &#39;53181&#39;, &#39;43204&#39;],
##       dtype=object)</code></pre>
<p>Al revisar las variables se puede apreciar que los precios tienen un error de formateo dado que están en formato de “string”, lo cual indica que es necesario posteriormente llevar a cabo una operación de casteo que lleve estos valores precio a valores númericos.</p>
<p>Ahora se procede a revisar la columna de tendencia:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb27-1" tabindex="-1"></a></span>
<span id="cb27-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb27-2" tabindex="-1"></a>df_sipsa[<span class="st">&quot;Tendencia&quot;</span>].unique()</span></code></pre></div>
<pre><code>## array([&#39;++&#39;, &#39;+&#39;, &#39;-&#39;, &#39;=&#39;, &#39;+++&#39;, &#39;n.d.&#39;, &#39;--&#39;, &#39;---&#39;, &#39;Tend&#39;, nan,
##        &#39;n,d,&#39;], dtype=object)</code></pre>
<p>Para el caso de esta columna se pueden apreciar valores inusuales como ‘Tend’ y ‘n,d,’ lo cual hace necesario validar las columnas con estos registros con el fin si es necesario eliminar filas o simplemente reformatear registros.</p>
<p>Ahora procedamos a revisar la columna “Producto”</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb29-1" tabindex="-1"></a></span>
<span id="cb29-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb29-2" tabindex="-1"></a>df_sipsa[<span class="st">&quot;Producto&quot;</span>].unique()</span></code></pre></div>
<pre><code>## array([&#39;Acelga&#39;, &#39;Ahuyama&#39;, &#39;Ahuyamín (Sakata)&#39;, &#39;Ají topito dulce&#39;,
##        &#39;Ajo&#39;, &#39;Ajo importado&#39;, &#39;Apio&#39;, &#39;Arveja verde en vaina&#39;,
##        &#39;Arveja verde en vaina pastusa&#39;, &#39;Berenjena&#39;, &#39;Brócoli&#39;,
##        &#39;Calabacín&#39;, &#39;Calabaza&#39;, &#39;Cebolla cabezona blanca&#39;,
##        &#39;Cebolla cabezona blanca bogotana&#39;,
##        &#39;Cebolla cabezona blanca importada&#39;,
##        &#39;Cebolla cabezona blanca pastusa&#39;, &#39;Cebolla cabezona roja&#39;,
##        &#39;Cebolla cabezona roja importada&#39;, &#39;Cebolla cabezona roja ocañera&#39;,
##        &#39;Cebolla cabezona roja peruana&#39;, &#39;Cebolla junca&#39;,
##        &#39;Cebolla junca Aquitania&#39;, &#39;Cebolla junca Berlín&#39;,
##        &#39;Cebolla junca pastusa&#39;, &#39;Cebolla junca Tenerife&#39;,
##        &#39;Cebolla puerro&#39;, &#39;Cebollín chino&#39;, &#39;Chócolo mazorca&#39;, &#39;Cidra&#39;,
##        &#39;Cilantro&#39;, &#39;Coles&#39;, &#39;Coliflor&#39;, &#39;Espinaca&#39;, &#39;Fríjol verde bolo&#39;,
##        &#39;Fríjol verde cargamanto&#39;, &#39;Fríjol verde en vaina&#39;, &#39;Haba verde&#39;,
##        &#39;Habichuela&#39;, &#39;Habichuela larga&#39;, &#39;Lechuga Batavia&#39;,
##        &#39;Lechuga crespa morada&#39;, &#39;Lechuga crespa verde&#39;, &#39;Pepino cohombro&#39;,
##        &#39;Pepino de rellenar&#39;, &#39;Perejil&#39;, &#39;Pimentón&#39;, &#39;Pimentón verde&#39;,
##        &#39;Rábano rojo&#39;, &#39;Remolacha&#39;, &#39;Remolacha bogotana&#39;,
##        &#39;Remolacha regional&#39;, &#39;Repollo blanco&#39;, &#39;Repollo blanco bogotano&#39;,
##        &#39;Repollo morado&#39;, &#39;Repollo verde&#39;, &#39;Tomate chonto&#39;,
##        &#39;Tomate chonto regional&#39;, &#39;Tomate larga vida&#39;, &#39;Tomate riñón&#39;,
##        &#39;Tomate riñón valluno&#39;, &#39;Tomate Riogrande&#39;,
##        &#39;Tomate Riogrande bumangués&#39;, &#39;Tomate Riogrande ocañero&#39;,
##        &#39;Zanahoria&#39;, &#39;Zanahoria bogotana&#39;, &#39;Zanahoria larga vida&#39;,
##        &#39;Aguacate común&#39;, &#39;Aguacate Hass&#39;, &#39;Aguacate papelillo&#39;, &#39;Badea&#39;,
##        &#39;Banano bocadillo&#39;, &#39;Banano criollo&#39;, &#39;Banano Urabá&#39;, &#39;Borojó&#39;,
##        &#39;Breva&#39;, &#39;Ciruela importada&#39;, &#39;Ciruela roja&#39;, &#39;Coco&#39;, &#39;Curuba&#39;,
##        &#39;Durazno importado&#39;, &#39;Durazno nacional&#39;, &#39;Feijoa&#39;, &#39;Fresa&#39;,
##        &#39;Granadilla&#39;, &#39;Guanábana&#39;, &#39;Guayaba agria&#39;, &#39;Guayaba Atlántico&#39;,
##        &#39;Guayaba común&#39;, &#39;Guayaba manzana&#39;, &#39;Guayaba pera&#39;,
##        &#39;Guayaba pera valluna&#39;, &#39;Gulupa&#39;, &#39;Higo&#39;, &#39;Kiwi&#39;, &#39;Limón común&#39;,
##        &#39;Limón común Ciénaga&#39;, &#39;Limón común valluno&#39;, &#39;Limón mandarino&#39;,
##        &#39;Limón Tahití&#39;, &#39;Lulo&#39;, &#39;Mandarina Arrayana&#39;, &#39;Mandarina común&#39;,
##        &#39;Mandarina Oneco&#39;, &#39;Mango común&#39;, &#39;Mango de azúcar&#39;,
##        &#39;Mango manzano&#39;, &#39;Mango reina&#39;, &#39;Mango Tommy&#39;, &#39;Mango Yulima&#39;,
##        &#39;Manzana nacional&#39;, &#39;Manzana roja importada&#39;,
##        &#39;Manzana royal gala importada&#39;, &#39;Manzana verde importada&#39;,
##        &#39;Maracuyá&#39;, &#39;Maracuyá antioqueño&#39;, &#39;Maracuyá huilense&#39;,
##        &#39;Maracuyá santandereano&#39;, &#39;Maracuyá valluno&#39;, &#39;Melón Cantalup&#39;,
##        &#39;Mora de Castilla&#39;, &#39;Naranja común&#39;, &#39;Naranja Sweet&#39;,
##        &#39;Naranja Valencia&#39;, &#39;Papaya hawaiana&#39;, &#39;Papaya Maradol&#39;,
##        &#39;Papaya melona&#39;, &#39;Papaya redonda&#39;, &#39;Papaya tainung&#39;, &#39;Patilla&#39;,
##        &#39;Patilla baby&#39;, &#39;Pera importada&#39;, &#39;Pera nacional&#39;, &#39;Piña gold&#39;,
##        &#39;Piña manzana&#39;, &#39;Piña perolera&#39;, &#39;Pitahaya&#39;, &#39;Tangelo&#39;,
##        &#39;Tomate de árbol&#39;, &#39;Uchuva con cáscara&#39;, &#39;Uva importada&#39;,
##        &#39;Uva Isabela&#39;, &#39;Uva negra&#39;, &#39;Uva red globe nacional&#39;, &#39;Uva roja&#39;,
##        &#39;Uva verde&#39;, &#39;Zapote&#39;, &#39;Arracacha amarilla&#39;, &#39;Arracacha blanca&#39;,
##        &#39;Ñame criollo&#39;, &#39;Ñame diamante&#39;, &#39;Ñame espino&#39;, &#39;Papa Betina&#39;,
##        &#39;Papa capira&#39;, &#39;Papa criolla limpia&#39;, &#39;Papa criolla sucia&#39;,
##        &#39;Papa ICA-Huila&#39;, &#39;Papa Morasurco&#39;, &#39;Papa nevada&#39;,
##        &#39;Papa parda pastusa&#39;, &#39;Papa Puracé&#39;, &#39;Papa roja peruana&#39;,
##        &#39;Papa rubí&#39;, &#39;Papa R-12 negra&#39;, &#39;Papa R-12 roja&#39;, &#39;Papa sabanera&#39;,
##        &#39;Papa San Félix&#39;, &#39;Papa superior&#39;, &#39;Papa suprema&#39;,
##        &#39;Papa tocarreña&#39;, &#39;Papa única&#39;, &#39;Plátano comino&#39;,
##        &#39;Plátano dominico hartón maduro&#39;, &#39;Plátano dominico hartón verde&#39;,
##        &#39;Plátano dominico verde&#39;, &#39;Plátano guineo&#39;,
##        &#39;Plátano hartón maduro&#39;, &#39;Plátano hartón verde&#39;,
##        &#39;Plátano hartón verde ecuatoriano&#39;,
##        &#39;Plátano hartón verde Eje Cafetero&#39;,
##        &#39;Plátano hartón verde llanero&#39;, &#39;Ulluco&#39;, &#39;Yuca chirosa&#39;,
##        &#39;Yuca criolla&#39;, &#39;Yuca ICA&#39;, &#39;Yuca llanera&#39;,
##        &#39;Arroz blanco importado&#39;, &#39;Arroz de primera&#39;, &#39;Arroz de segunda&#39;,
##        &#39;Arroz excelso&#39;, &#39;Arroz sopa cristal&#39;,
##        &#39;Arveja amarilla seca importada&#39;, &#39;Arveja verde seca importada&#39;,
##        &#39;Cuchuco de cebada&#39;, &#39;Cuchuco de maíz&#39;, &#39;Fríjol bolón&#39;,
##        &#39;Fríjol cabeza negra importado&#39;, &#39;Fríjol cabeza negra nacional&#39;,
##        &#39;Fríjol calima&#39;, &#39;Fríjol cargamanto blanco&#39;,
##        &#39;Fríjol cargamanto rojo&#39;, &#39;Fríjol nima calima&#39;,
##        &#39;Fríjol palomito importado&#39;, &#39;Fríjol radical&#39;,
##        &#39;Fríjol Uribe rosado&#39;, &#39;Fríjol Zaragoza&#39;, &#39;Garbanzo importado&#39;,
##        &#39;Lenteja importada&#39;, &#39;Maíz amarillo cáscara&#39;,
##        &#39;Maíz amarillo cáscara importado&#39;, &#39;Maíz amarillo trillado&#39;,
##        &#39;Maíz blanco cáscara&#39;, &#39;Maíz blanco retrillado&#39;,
##        &#39;Maíz blanco trillado&#39;, &#39;Maíz pira&#39;, &#39;Huevo blanco A&#39;,
##        &#39;Huevo blanco AA&#39;, &#39;Huevo blanco B&#39;, &#39;Huevo blanco extra&#39;,
##        &#39;Huevo rojo A&#39;, &#39;Huevo rojo AA&#39;, &#39;Huevo rojo B&#39;,
##        &#39;Huevo rojo extra&#39;, &#39;Leche en polvo&#39;, &#39;Queso campesino&#39;,
##        &#39;Queso Caquetá&#39;, &#39;Queso costeño&#39;, &#39;Queso cuajada&#39;,
##        &#39;Queso doble crema&#39;, &#39;Alas de pollo con costillar&#39;,
##        &#39;Alas de pollo sin costillar&#39;, &#39;Carne de cerdo, brazo con hueso&#39;,
##        &#39;Carne de cerdo, brazo sin hueso&#39;,
##        &#39;Carne de cerdo, cabeza de lomo&#39;, &#39;Carne de cerdo, costilla&#39;,
##        &#39;Carne de cerdo en canal&#39;, &#39;Carne de cerdo, espinazo&#39;,
##        &#39;Carne de cerdo, lomo con hueso&#39;, &#39;Carne de cerdo, lomo sin hueso&#39;,
##        &#39;Carne de cerdo, pernil con hueso&#39;,
##        &#39;Carne de cerdo, pernil sin hueso&#39;,
##        &#39;Carne de cerdo, tocineta plancha&#39;,
##        &#39;Carne de cerdo, tocino barriga&#39;, &#39;Carne de cerdo, tocino papada&#39;,
##        &#39;Carne de res, bola de brazo&#39;, &#39;Carne de res, bola de pierna&#39;,
##        &#39;Carne de res, bota&#39;, &#39;Carne de res, cadera&#39;,
##        &#39;Carne de res, centro de pierna&#39;, &#39;Carne de res, chatas&#39;,
##        &#39;Carne de res, cogote&#39;, &#39;Carne de res, costilla&#39;,
##        &#39;Carne de res en canal&#39;, &#39;Carne de res, falda&#39;,
##        &#39;Carne de res, lomo de brazo&#39;, &#39;Carne de res, lomo fino&#39;,
##        &#39;Carne de res molida, murillo&#39;, &#39;Carne de res, morrillo&#39;,
##        &#39;Carne de res, muchacho&#39;, &#39;Carne de res, murillo&#39;,
##        &#39;Carne de res, paletero&#39;, &#39;Carne de res, pecho&#39;,
##        &#39;Carne de res, punta de anca&#39;, &#39;Carne de res, sobrebarriga&#39;,
##        &#39;Menudencias de pollo&#39;, &#39;Muslos de pollo con rabadilla&#39;,
##        &#39;Muslos de pollo sin rabadilla&#39;, &#39;Pechuga de pollo&#39;,
##        &#39;Pierna pernil con rabadilla&#39;, &#39;Pierna pernil sin rabadilla&#39;,
##        &#39;Piernas de pollo&#39;, &#39;Pollo entero congelado sin vísceras&#39;,
##        &#39;Pollo entero fresco con vísceras&#39;,
##        &#39;Pollo entero fresco sin vísceras&#39;, &#39;Rabadillas de pollo&#39;,
##        &#39;Almejas con concha&#39;, &#39;Almejas sin concha&#39;,
##        &#39;Bagre rayado en postas congelado&#39;,
##        &#39;Bagre rayado entero congelado&#39;, &#39;Bagre rayado entero fresco&#39;,
##        &#39;Blanquillo entero fresco&#39;, &#39;Bocachico criollo fresco&#39;,
##        &#39;Bocachico importado congelado&#39;, &#39;Cachama de cultivo fresca&#39;,
##        &#39;Calamar anillos&#39;, &#39;Calamar blanco entero&#39;,
##        &#39;Calamar morado entero&#39;, &#39;Camarón tigre precocido seco&#39;,
##        &#39;Camarón tití precocido seco&#39;, &#39;Capaz Magdalena fresco&#39;,
##        &#39;Cazuela de mariscos (paquete)&#39;,
##        &#39;Corvina, filete congelado nacional&#39;, &#39;Langostino U12&#39;,
##        &#39;Langostino 16-20&#39;, &#39;Merluza, filete importado&#39;,
##        &#39;Merluza, filete nacional&#39;, &#39;Mojarra lora entera congelada&#39;,
##        &#39;Mojarra lora entera fresca&#39;, &#39;Nicuro fresco&#39;, &#39;Palmitos de mar&#39;,
##        &#39;Pargo rojo entero congelado&#39;, &#39;Pargo rojo entero fresco&#39;,
##        &#39;Pargo rojo platero&#39;, &#39;Pescado cabezas&#39;,
##        &#39;Róbalo, filete congelado&#39;, &#39;Salmón, filete congelado&#39;,
##        &#39;Sierra entera congelada&#39;, &#39;Tilapia, filete congelado&#39;,
##        &#39;Tilapia, lomitos&#39;, &#39;Tilapia roja entera congelada&#39;,
##        &#39;Tilapia roja entera fresca&#39;, &#39;Toyo blanco, filete congelado&#39;,
##        &#39;Trucha en corte mariposa&#39;, &#39;Trucha entera fresca&#39;,
##        &#39;Aceite girasol&#39;, &#39;Aceite soya&#39;, &#39;Aceite vegetal mezcla&#39;,
##        &#39;Arveja enlatada&#39;, &#39;Avena en hojuelas&#39;, &#39;Avena molida&#39;,
##        &#39;Azúcar morena&#39;, &#39;Azúcar refinada&#39;, &#39;Azúcar sulfitada&#39;,
##        &#39;Bocadillo veleño&#39;, &#39;Café instantáneo&#39;, &#39;Café molido&#39;,
##        &#39;Chocolate amargo&#39;, &#39;Chocolate dulce&#39;, &#39;Chocolate instantáneo&#39;,
##        &#39;Color (bolsita)&#39;, &#39;Fécula de maíz&#39;, &#39;Fríjol enlatado&#39;,
##        &#39;Galletas dulces redondas con crema&#39;, &#39;Galletas saladas&#39;,
##        &#39;Gelatina&#39;, &#39;Harina de trigo&#39;, &#39;Harina precocida de maíz&#39;,
##        &#39;Jugo de frutas&#39;, &#39;Jugo instantáneo (sobre)&#39;,
##        &#39;Lomitos de atún en lata&#39;, &#39;Maíz enlatado&#39;, &#39;Manteca&#39;, &#39;Margarina&#39;,
##        &#39;Mayonesa doy pack&#39;, &#39;Mostaza doy pack&#39;, &#39;Panela cuadrada blanca&#39;,
##        &#39;Panela cuadrada morena&#39;, &#39;Panela en pastilla&#39;,
##        &#39;Panela redonda blanca&#39;, &#39;Panela redonda morena&#39;,
##        &#39;Pastas alimenticias&#39;, &#39;Sal yodada&#39;, &#39;Salsa de tomate doy pack&#39;,
##        &#39;Sardinas en lata&#39;, &#39;Sopa de pollo (caja)&#39;, &#39;Vinagre&#39;,
##        &#39;Mango costeño&#39;, &#39;Mango Kent&#39;, nan,
##        &#39;Basa, filete congelado importado&#39;,
##        &#39;Basa, entero congelado importado&#39;,
##        &#39;Menor a -12%                    ---&#39;,
##        &#39;Entre -12% y -7%               --&#39;,
##        &#39;Entre -6,99% y -3%            -&#39;,
##        &#39;Entre -2,99% y 3%              =&#39;,
##        &#39;Entre 3,01% y 7%               +&#39;,
##        &#39;Entre 7,01% y 12%             ++&#39;,
##        &#39;Mayor a 12%                      +++&#39;, &#39;c&#39;,
##        &#39;Arroz blanco empacado&#39;, &#39;Arroz blanco en bulto&#39;, &#39;Arroz cristal&#39;,
##        &#39;Arroz granza&#39;, &#39;Arroz paddy verde&#39;, &#39;Harina de arroz&#39;,
##        &#39;Menor a -12,01%              ---&#39;,
##        &#39;Entre -7,01% y -12%         --&#39;, &#39;Entre -3,01% y -7%           -&#39;,
##        &#39;Entre 3% y -3%                 =&#39;,
##        &#39;Entre 3,01% y 7%             +&#39;, &#39;Entre 7,01% y 12%           ++&#39;,
##        &#39;Mayor a 12,01%               +++&#39;, &#39;Papaya Paulina&#39;,
##        &#39;Mandarina arrayana&#39;, &#39;Aceite de palma&#39;, &#39;Ají Topito Dulce&#39;,
##        &#39;Ajo Importado&#39;, &#39;Arveja Verde en Vaina&#39;,
##        &#39;Arveja Verde en Vaina Pastusa&#39;, &#39;Cebolla Cabezona Blanca&#39;,
##        &#39;Cebolla Cabezona Blanca Bogotana&#39;,
##        &#39;Cebolla Cabezona Blanca Importada&#39;,
##        &#39;Cebolla Cabezona Blanca Pastusa&#39;, &#39;Cebolla Cabezona Roja&#39;,
##        &#39;Cebolla Cabezona Roja Importada&#39;, &#39;Cebolla Cabezona Roja Ocañera&#39;,
##        &#39;Cebolla Cabezona Roja Peruana&#39;, &#39;Cebolla Junca&#39;,
##        &#39;Cebolla Junca Aquitania&#39;, &#39;Cebolla Junca Berlín&#39;,
##        &#39;Cebolla Junca Pastusa&#39;, &#39;Cebolla Junca Tenerife&#39;,
##        &#39;Cebolla Puerro&#39;, &#39;Cebollín Chino&#39;, &#39;Chócolo Mazorca&#39;,
##        &#39;Fríjol Verde Bolo&#39;, &#39;Fríjol Verde Cargamanto&#39;,
##        &#39;Fríjol Verde en Vaina&#39;, &#39;Haba Verde&#39;, &#39;Habichuela Larga&#39;,
##        &#39;Lechuga Crespa Verde&#39;, &#39;Pepino Cohombro&#39;, &#39;Pepino de Rellenar&#39;,
##        &#39;Pimentón Verde&#39;, &#39;Rábano Rojo&#39;, &#39;Remolacha Bogotana&#39;,
##        &#39;Remolacha Regional&#39;, &#39;Repollo Blanco&#39;, &#39;Repollo Blanco Bogotano&#39;,
##        &#39;Repollo Blanco Valluno&#39;, &#39;Repollo Morado&#39;, &#39;Repollo Verde&#39;,
##        &#39;Tomate Chonto&#39;, &#39;Tomate Chonto Regional&#39;, &#39;Tomate Chonto Valluno&#39;,
##        &#39;Tomate Larga Vida&#39;, &#39;Tomate Riñón&#39;, &#39;Tomate Riñón Valluno&#39;,
##        &#39;Tomate Riogrande Bumangués&#39;, &#39;Tomate Riogrande Ocañero&#39;,
##        &#39;Zanahoria Bogotana&#39;, &#39;Zanahoria Larga Vida&#39;, &#39;Aguacate Común&#39;,
##        &#39;Aguacate Papelillo&#39;, &#39;Banano Bocadillo&#39;, &#39;Banano Criollo&#39;,
##        &#39;Ciruela Importada&#39;, &#39;Ciruela Roja&#39;, &#39;Durazno Nacional&#39;,
##        &#39;Guayaba Agria&#39;, &#39;Guayaba Común&#39;, &#39;Guayaba Manzana&#39;,
##        &#39;Guayaba Pera&#39;, &#39;Guayaba Pera Valluna&#39;, &#39;Limón Común&#39;,
##        &#39;Limón Común Ciénaga&#39;, &#39;Limón Común Valluno&#39;, &#39;Limón Mandarino&#39;,
##        &#39;Mandarina Común&#39;, &#39;Mango Común&#39;, &#39;Mango de Azúcar&#39;,
##        &#39;Mango Manzano&#39;, &#39;Mango Reina&#39;, &#39;Manzana Nacional&#39;,
##        &#39;Manzana Roja Importada&#39;, &#39;Manzana Royal Gala Importada&#39;,
##        &#39;Manzana Verde Importada&#39;, &#39;Maracuyá Antioqueño&#39;,
##        &#39;Maracuyá Huilense&#39;, &#39;Maracuyá Santandereano&#39;, &#39;Maracuyá Valluno&#39;,
##        &#39;Naranja Común&#39;, &#39;Papaya Hawaiana&#39;, &#39;Papaya Tainung&#39;,
##        &#39;Patilla Baby&#39;, &#39;Pera Importada&#39;, &#39;Pera Nacional&#39;, &#39;Piña Gold&#39;,
##        &#39;Piña Manzana&#39;, &#39;Piña Perolera&#39;, &#39;Tomate de Árbol&#39;,
##        &#39;Uchuva con Cáscara&#39;, &#39;Uva Importada&#39;, &#39;Uva Red Globe Nacional&#39;,
##        &#39;Uva Roja&#39;, &#39;Uva Verde&#39;, &#39;Arracacha Amarilla&#39;, &#39;Arracacha Blanca&#39;,
##        &#39;Ñame Criollo&#39;, &#39;Ñame Diamante&#39;, &#39;Ñame Espino&#39;, &#39;Papa Capira&#39;,
##        &#39;Papa Criolla Limpia&#39;, &#39;Papa Criolla Sucia&#39;, &#39;Papa Ica-Huila&#39;,
##        &#39;Papa Nevada&#39;, &#39;Papa Parda Pastusa&#39;, &#39;Papa R-12 Negra&#39;,
##        &#39;Papa R-12 Roja&#39;, &#39;Papa Roja Peruana&#39;, &#39;Papa Rubí&#39;,
##        &#39;Papa Sabanera&#39;, &#39;Papa Superior&#39;, &#39;Papa Suprema&#39;, &#39;Papa Única&#39;,
##        &#39;Plátano Comino&#39;, &#39;Plátano Dominico Hartón Maduro&#39;,
##        &#39;Plátano Dominico Hartón Verde&#39;, &#39;Plátano Dominico Verde&#39;,
##        &#39;Plátano Guineo&#39;, &#39;Plátano Hartón Maduro&#39;, &#39;Plátano Hartón Verde&#39;,
##        &#39;Plátano Hartón Verde Ecuatoriano&#39;,
##        &#39;Plátano Hartón Verde Eje Cafetero&#39;,
##        &#39;Plátano Hartón Verde Llanero&#39;, &#39;Yuca Chirosa&#39;, &#39;Yuca Criolla&#39;,
##        &#39;Yuca Ica&#39;, &#39;Yuca Llanera&#39;, &#39;Arroz Blanco Importado&#39;,
##        &#39;Arroz de Primera&#39;, &#39;Arroz de Segunda&#39;, &#39;Arroz Excelso&#39;,
##        &#39;Arroz Sopa Cristal&#39;, &#39;Arveja Amarilla Seca Importada&#39;,
##        &#39;Arveja Enlatada&#39;, &#39;Arveja Verde Seca Importada&#39;,
##        &#39;Cuchuco de Cebada&#39;, &#39;Cuchuco de Maíz&#39;, &#39;Fríjol Bolón&#39;,
##        &#39;Fríjol Cabeza Negra Importado&#39;, &#39;Fríjol Cabeza Negra Nacional&#39;,
##        &#39;Fríjol Calima&#39;, &#39;Fríjol Cargamanto Blanco&#39;,
##        &#39;Fríjol Cargamanto Rojo&#39;, &#39;Fríjol Enlatado&#39;, &#39;Fríjol Nima Calima&#39;,
##        &#39;Fríjol Palomito Importado&#39;, &#39;Fríjol Radical&#39;,
##        &#39;Fríjol Uribe Rosado&#39;, &#39;Garbanzo Importado&#39;, &#39;Lenteja Importada&#39;,
##        &#39;Maíz Amarillo Cáscara&#39;, &#39;Maíz Amarillo Cáscara Importado&#39;,
##        &#39;Maíz Amarillo Trillado&#39;, &#39;Maíz Blanco Cáscara&#39;,
##        &#39;Maíz Blanco Retrillado&#39;, &#39;Maíz Blanco Trillado&#39;, &#39;Maíz Pira&#39;,
##        &#39;Huevo Blanco A&#39;, &#39;Huevo Blanco AA&#39;, &#39;Huevo Blanco B&#39;,
##        &#39;Huevo Blanco Extra&#39;, &#39;Huevo Rojo A&#39;, &#39;Huevo Rojo AA&#39;,
##        &#39;Huevo Rojo B&#39;, &#39;Huevo Rojo Extra&#39;, &#39;Leche en Polvo&#39;,
##        &#39;Queso Campesino&#39;, &#39;Queso Costeño&#39;, &#39;Queso Cuajada&#39;,
##        &#39;Queso Doble Crema&#39;, &#39;Alas de Pollo con Costillar&#39;,
##        &#39;Alas de Pollo sin Costillar&#39;, &#39;Carne de Cerdo en Canal&#39;,
##        &#39;Carne de Cerdo, Brazo con Hueso&#39;,
##        &#39;Carne de Cerdo, Brazo sin Hueso&#39;,
##        &#39;Carne de Cerdo, Cabeza de Lomo&#39;, &#39;Carne de Cerdo, Costilla&#39;,
##        &#39;Carne de Cerdo, Espinazo&#39;, &#39;Carne de Cerdo, Lomo con Hueso&#39;,
##        &#39;Carne de Cerdo, Lomo sin Hueso&#39;,
##        &#39;Carne de Cerdo, Pernil con Hueso&#39;,
##        &#39;Carne de Cerdo, Pernil sin Hueso&#39;,
##        &#39;Carne de Cerdo, Tocineta Plancha&#39;,
##        &#39;Carne de Cerdo, Tocino Barriga&#39;, &#39;Carne de Cerdo, Tocino Papada&#39;,
##        &#39;Carne de Res en Canal&#39;, &#39;Carne de Res Molida, Murillo&#39;,
##        &#39;Carne de Res, Bola de Brazo&#39;, &#39;Carne de Res, Bola de Pierna&#39;,
##        &#39;Carne de Res, Bota&#39;, &#39;Carne de Res, Cadera&#39;,
##        &#39;Carne de Res, Centro de Pierna&#39;, &#39;Carne de Res, Chatas&#39;,
##        &#39;Carne de Res, Cogote&#39;, &#39;Carne de Res, Costilla&#39;,
##        &#39;Carne de Res, Falda&#39;, &#39;Carne de Res, Lomo de Brazo&#39;,
##        &#39;Carne de Res, Lomo Fino&#39;, &#39;Carne de Res, Morrillo&#39;,
##        &#39;Carne de Res, Muchacho&#39;, &#39;Carne de Res, Murillo&#39;,
##        &#39;Carne de Res, Paletero&#39;, &#39;Carne de Res, Pecho&#39;,
##        &#39;Carne de Res, Punta de Anca&#39;, &#39;Carne de Res, Sobrebarriga&#39;,
##        &#39;Menudencias de Pollo&#39;, &#39;Muslos de Pollo con Rabadilla&#39;,
##        &#39;Muslos de Pollo sin Rabadilla&#39;, &#39;Pechuga de Pollo&#39;,
##        &#39;Pierna Pernil con Rabadilla&#39;, &#39;Pierna Pernil sin Rabadilla&#39;,
##        &#39;Piernas de Pollo&#39;, &#39;Pollo Entero Congelado sin Vísceras&#39;,
##        &#39;Pollo Entero Fresco sin Vísceras&#39;, &#39;Rabadillas de Pollo&#39;,
##        &#39;Almejas con Concha&#39;, &#39;Almejas sin Concha&#39;,
##        &#39;Bagre Rayado en Postas Congelado&#39;,
##        &#39;Bagre Rayado Entero Congelado&#39;, &#39;Bagre Rayado Entero Fresco&#39;,
##        &#39;Basa, Entero Congelado Importado&#39;,
##        &#39;Basa, Filete Congelado Importado&#39;, &#39;Blanquillo Entero Fresco&#39;,
##        &#39;Bocachico Criollo Fresco&#39;, &#39;Bocachico Importado Congelado&#39;,
##        &#39;Cachama de Cultivo Fresca&#39;, &#39;Calamar Anillos&#39;,
##        &#39;Calamar Blanco Entero&#39;, &#39;Calamar Morado Entero&#39;,
##        &#39;Camarón Tigre Precocido Seco&#39;, &#39;Camarón Tití Precocido Seco&#39;,
##        &#39;Capaz Magdalena Fresco&#39;, &#39;Cazuela de Mariscos (Paquete)&#39;,
##        &#39;Corvina, Filete Congelado Nacional&#39;, &#39;Merluza, Filete Importado&#39;,
##        &#39;Merluza, Filete Nacional&#39;, &#39;Mojarra Lora Entera Congelada&#39;,
##        &#39;Mojarra Lora Entera Fresca&#39;, &#39;Nicuro Fresco&#39;, &#39;Palmitos de Mar&#39;,
##        &#39;Pargo Rojo Entero Congelado&#39;, &#39;Pargo Rojo Platero&#39;,
##        &#39;Pescado Cabezas&#39;, &#39;Róbalo, Filete Congelado&#39;,
##        &#39;Salmón, Filete Congelado&#39;, &#39;Sierra Entera Congelada&#39;,
##        &#39;Tilapia Roja Entera Congelada&#39;, &#39;Tilapia Roja Entera Fresca&#39;,
##        &#39;Tilapia, Filete Congelado&#39;, &#39;Trucha en Corte Mariposa&#39;,
##        &#39;Trucha Entera Fresca&#39;, &#39;Aceite Girasol&#39;, &#39;Aceite Soya&#39;,
##        &#39;Aceite de Palma&#39;, &#39;Aceite Vegetal Mezcla&#39;, &#39;Avena en Hojuelas&#39;,
##        &#39;Avena Molida&#39;, &#39;Azúcar Morena&#39;, &#39;Azúcar Refinada&#39;,
##        &#39;Azúcar Sulfitada&#39;, &#39;Bocadillo Veleño&#39;, &#39;Café Instantáneo&#39;,
##        &#39;Café Molido&#39;, &#39;Chocolate Amargo&#39;, &#39;Chocolate Dulce&#39;,
##        &#39;Chocolate Instantáneo&#39;, &#39;Color (Bolsita)&#39;, &#39;Fécula de Maíz&#39;,
##        &#39;Galletas Dulces Redondas con Crema&#39;, &#39;Galletas Saladas&#39;,
##        &#39;Harina de Trigo&#39;, &#39;Harina Precocida de Maíz&#39;, &#39;Jugo de Frutas&#39;,
##        &#39;Jugo Instantáneo (Sobre)&#39;, &#39;Lomitos de Atún en Lata&#39;,
##        &#39;Maíz Enlatado&#39;, &#39;Mayonesa Doy Pack&#39;, &#39;Mostaza Doy Pack&#39;,
##        &#39;Panela Cuadrada Blanca&#39;, &#39;Panela Cuadrada Morena&#39;,
##        &#39;Panela en Pastilla&#39;, &#39;Panela Redonda Blanca&#39;,
##        &#39;Panela Redonda Morena&#39;, &#39;Pastas Alimenticias&#39;, &#39;Sal Yodada&#39;,
##        &#39;Salsa de Tomate Doy Pack&#39;, &#39;Sardinas en Lata&#39;,
##        &#39;Sopa de Pollo (Caja)&#39;, &#39;Repollo blanco valluno&#39;,
##        &#39;Tomate chonto valluno&#39;], dtype=object)</code></pre>
<p>Se identifican registros intrusos que no lograron ser depurados totalmente en la consolidación, estos corresponden a secciones de explicación de convenciones de tendencia:</p>
<p>Menor a -12% —‘,
’Entre -12% y -7% –’,
‘Entre -6,99% y -3% -’,
‘Entre -2,99% y 3% =’,
‘Entre 3,01% y 7% +’,
‘Entre 7,01% y 12% ++’,
‘Mayor a 12% +++’, ‘c’,</p>
<p>‘Menor a -12,01% —’,
‘Entre -7,01% y -12% –’, ‘Entre -3,01% y -7% -’,
‘Entre 3% y -3% =’,
‘Entre 3,01% y 7% +’, ‘Entre 7,01% y 12% ++’,
‘Mayor a 12,01% +++’,</p>
<p>Se hace necesario limpiar estos registros ya que generan espacios con “nan” en las demás columnas, además no aportan a los datos.</p>
<p>A partir de los hallazgos realizados en la exploración de los registros en cada columna se crean las siguientes lineas de código con el fin de corregir los errores identificados:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-1" tabindex="-1"></a></span>
<span id="cb31-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-2" tabindex="-1"></a><span class="co"># se procede a eliminar los registros de la columna tendencia con valor &quot;Tend&quot;</span></span>
<span id="cb31-3"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-3" tabindex="-1"></a></span>
<span id="cb31-4"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-4" tabindex="-1"></a>df_sipsa<span class="op">=</span> df_sipsa[df_sipsa[<span class="st">&quot;Tendencia&quot;</span>]<span class="op">!=</span><span class="st">&quot;Tend&quot;</span>]</span>
<span id="cb31-5"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-5" tabindex="-1"></a></span>
<span id="cb31-6"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-6" tabindex="-1"></a><span class="co"># se procede a reemplazar los registros de la columna tendencia con valor &quot;n,d&quot;</span></span>
<span id="cb31-7"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-7" tabindex="-1"></a></span>
<span id="cb31-8"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-8" tabindex="-1"></a>df_sipsa.loc[<span class="st">&quot;Tendencia&quot;</span>]<span class="op">=</span> df_sipsa[<span class="st">&quot;Tendencia&quot;</span>].replace(<span class="st">&#39;n,d,&#39;</span>,<span class="st">&quot;n.d&quot;</span>)</span>
<span id="cb31-9"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-9" tabindex="-1"></a></span>
<span id="cb31-10"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-10" tabindex="-1"></a><span class="co"># Se eliminan los registros intrusos que quedaron producto de convenciones que quedaron </span></span>
<span id="cb31-11"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-11" tabindex="-1"></a><span class="co"># residualmente en el set de datos consolidado</span></span>
<span id="cb31-12"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-12" tabindex="-1"></a></span>
<span id="cb31-13"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-13" tabindex="-1"></a>lista_anomalias<span class="op">=</span>[<span class="st">&#39;Menor a -12%                    ---&#39;</span>,</span>
<span id="cb31-14"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-14" tabindex="-1"></a>                <span class="st">&#39;Entre -12% y -7%               --&#39;</span>,</span>
<span id="cb31-15"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-15" tabindex="-1"></a>                <span class="st">&#39;Entre -6,99% y -3%            -&#39;</span>,</span>
<span id="cb31-16"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-16" tabindex="-1"></a>                 <span class="st">&#39;Entre -2,99% y 3%              =&#39;</span>,</span>
<span id="cb31-17"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-17" tabindex="-1"></a>                 <span class="st">&#39;Entre 3,01% y 7%               +&#39;</span>,</span>
<span id="cb31-18"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-18" tabindex="-1"></a>                 <span class="st">&#39;Entre 7,01% y 12%             ++&#39;</span>,</span>
<span id="cb31-19"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-19" tabindex="-1"></a>                 <span class="st">&#39;Mayor a 12%                      +++&#39;</span>,</span>
<span id="cb31-20"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-20" tabindex="-1"></a>                 <span class="st">&#39;Menor a -12,01%              ---&#39;</span>,</span>
<span id="cb31-21"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-21" tabindex="-1"></a>                 <span class="st">&#39;Entre -7,01% y -12%         --&#39;</span>,</span>
<span id="cb31-22"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-22" tabindex="-1"></a>                 <span class="st">&#39;Entre -3,01% y -7%           -&#39;</span>,</span>
<span id="cb31-23"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-23" tabindex="-1"></a>                 <span class="st">&#39;Entre 3% y -3%                 =&#39;</span>,</span>
<span id="cb31-24"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-24" tabindex="-1"></a>                 <span class="st">&#39;Entre 3,01% y 7%             +&#39;</span>,</span>
<span id="cb31-25"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-25" tabindex="-1"></a>                 <span class="st">&#39;Entre 7,01% y 12%           ++&#39;</span>,</span>
<span id="cb31-26"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-26" tabindex="-1"></a>                 <span class="st">&#39;Mayor a 12,01%               +++&#39;</span>,</span>
<span id="cb31-27"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-27" tabindex="-1"></a>                 <span class="st">&#39;c&#39;</span>]</span>
<span id="cb31-28"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-28" tabindex="-1"></a></span>
<span id="cb31-29"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-29" tabindex="-1"></a>df_sipsa<span class="op">=</span> df_sipsa[df_sipsa[<span class="st">&quot;Producto&quot;</span>].isin(lista_anomalias)<span class="op">==</span><span class="va">False</span>]</span>
<span id="cb31-30"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-30" tabindex="-1"></a></span>
<span id="cb31-31"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-31" tabindex="-1"></a></span>
<span id="cb31-32"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb31-32" tabindex="-1"></a>df_sipsa.shape</span></code></pre></div>
<pre><code>## (1657994, 7)</code></pre>
<p>Despues de aplicar las operaciones de limpieza anteriores el set de datos queda con un total de 1’657.994 registros.</p>
<p>Dado que se ha finalizado la revisión de las columnas diferentes a periodo, ahora se procede a revisar el estado de los registros de la columna “Periodo” los cuales corresponden a los nombres de los ficheros que fueron procesados, de estos nombre se deberá extraer una fecha de referencia que sirva como base para la serie de tiempo:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb33-1" tabindex="-1"></a></span>
<span id="cb33-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb33-2" tabindex="-1"></a>df_sipsa[<span class="st">&quot;periodo&quot;</span>].unique()</span></code></pre></div>
<pre><code>## array([&#39;Sem_10dic_16dic_2016.xls&#39;, &#39;Sem_10sep_16sep_2016.xls&#39;,
##        &#39;Sem_11jun_17jun_2016.xls&#39;, &#39;Sem_12mar_18mar_2016.xls&#39;,
##        &#39;Sem_12nov_18nov_2016.xls&#39;, &#39;Sem_13ago_19ago_2016.xls&#39;,
##        &#39;Sem_13feb_19feb_2016.xls&#39;, &#39;Sem_14may_20may_2016.xls&#39;,
##        &#39;Sem_15oct_21oct_2016.xls&#39;, &#39;Sem_16abr_22abr_2016.xls&#39;,
##        &#39;Sem_16ene_22ene_2016.xls&#39;, &#39;Sem_16jul_22jul_2016.xls&#39;,
##        &#39;Sem_17dic_23dic_2016.xls&#39;, &#39;Sem_17sep_23sept_2016.xls&#39;,
##        &#39;Sem_18jun_24jun_2016.xls&#39;, &#39;Sem_19mar_23mar_2016.xls&#39;,
##        &#39;Sem_19nov_25nov_2016.xls&#39;, &#39;Sem_1oct_7oct_2016.xls&#39;,
##        &#39;Sem_20ago_26ago_2016.xls&#39;, &#39;Sem_20feb_26feb_2016.xls&#39;,
##        &#39;Sem_21may_27may_2016.xls&#39;, &#39;Sem_22oct_28oct_2016.xls&#39;,
##        &#39;Sem_23abr_29abr_2016.xls&#39;, &#39;Sem_23ene_29ene_2016.xls&#39;,
##        &#39;Sem_23jul_29jul_2016.xls&#39;, &#39;Sem_24dic_30dic_2016.xls&#39;,
##        &#39;Sem_24jun_1jul_2016.xls&#39;, &#39;Sem_24sep_30sep_2016.xls&#39;,
##        &#39;Sem_26mar_1abr_2016.xls&#39;, &#39;Sem_26nov_2dic_2016.xls&#39;,
##        &#39;Sem_27ago_2sep_2016.xls&#39;, &#39;Sem_27feb_4mar_2016.xls&#39;,
##        &#39;Sem_28may_3jun_2016.xls&#39;, &#39;Sem_29oct_04nov_2016.xls&#39;,
##        &#39;Sem_2abr_8abr_2016.xls&#39;, &#39;Sem_2ene_8ene_2016.xls&#39;,
##        &#39;Sem_2jul_8jul_2016.xls&#39;, &#39;Sem_30abr_06may_2016.xls&#39;,
##        &#39;Sem_30ene_5feb_2016.xls&#39;, &#39;Sem_30jul_5ago_2016.xls&#39;,
##        &#39;Sem_3dic_9dic_2016.xls&#39;, &#39;Sem_3sep_9sep_2016.xls&#39;,
##        &#39;Sem_4jun_10jun_2016.xls&#39;, &#39;Sem_5mar_11mar_2016.xls&#39;,
##        &#39;Sem_5nov_11nov_2016.xls&#39;, &#39;Sem_6ago_12ago_2016.xls&#39;,
##        &#39;Sem_6feb_12feb_2016.xls&#39;, &#39;Sem_7may_13may_2016.xls&#39;,
##        &#39;Sem_8oct_14oct_2016.xls&#39;, &#39;Sem_9abr_15abr_2016.xls&#39;,
##        &#39;Sem_9ene_15ene_2016.xls&#39;, &#39;Sem_9jul_15jul_2016.xls&#39;,
##        &#39;Sem_10jun_16jun_2017.xls&#39;, &#39;Sem_11feb_17feb_2017.xls&#39;,
##        &#39;Sem_11mar_17mar_2017.xls&#39;, &#39;Sem_11nov_17nov_2017.xls&#39;,
##        &#39;Sem_12ago_18ago_2017.xls&#39;, &#39;Sem_13abr_21abr_2017.xls&#39;,
##        &#39;Sem_13may_19may_2017.xls&#39;, &#39;Sem_14ene_2017_20ene_2017.xls&#39;,
##        &#39;Sem_14oct_2017_20oct_2017&#39;, &#39;Sem_15jul_21jul_2017.xls&#39;,
##        &#39;Sem_16dic_22dic_2017.xls&#39;, &#39;Sem_16sep_22sep_2017&#39;,
##        &#39;Sem_17jun_23jun_2017.xls&#39;, &#39;Sem_18feb_24feb_2017.xls&#39;,
##        &#39;Sem_18mar_24mar_2016.xls&#39;, &#39;Sem_18nov_24nov_2017.xls&#39;,
##        &#39;Sem_19ago_25ago_2017.xls&#39;, &#39;Sem_1abr_7abr_2017.xls&#39;,
##        &#39;Sem_1jul_7jul_2017.xls&#39;, &#39;Sem_20may_26may_2017.xls&#39;,
##        &#39;Sem_21ene_27ene_2017.xls&#39;, &#39;Sem_21oct_27oct_2017.xls&#39;,
##        &#39;Sem_22abr_28abr_2017.xls&#39;, &#39;Sem_22jul_28jul_2017.xls&#39;,
##        &#39;Sem_23dic_29dic_2017.xls&#39;, &#39;Sem_23sep_29sep_2017.xls&#39;,
##        &#39;Sem_24jun_30jun_2017.xls&#39;, &#39;Sem_25feb_3mar_2017.xls&#39;,
##        &#39;Sem_25mar_31mar_2017.xls&#39;, &#39;Sem_25nov_1dic_2017.xls&#39;,
##        &#39;Sem_26ago_1sep_2017.xls&#39;, &#39;Sem_27may_2jun_2017.xls&#39;,
##        &#39;Sem_28ene_3feb_2017.xls&#39;, &#39;Sem_28oct_3nov_2017.xls&#39;,
##        &#39;Sem_29abr_5may_2017.xls&#39;, &#39;Sem_29jul_4ago_2017.xls&#39;,
##        &#39;Sem_2dic_7dic_2017.xls&#39;, &#39;Sem_2sep_8sep_2017.xls&#39;,
##        &#39;Sem_30sep_6oct_2017.xls&#39;, &#39;Sem_31dic_2016_6ene_2017.xls&#39;,
##        &#39;Sem_3jun_9jun_2017.xls&#39;, &#39;Sem_4feb_10feb_2017.xls&#39;,
##        &#39;Sem_4mar_10mar_2017.xls&#39;, &#39;Sem_4nov_2017_10nov_2017&#39;,
##        &#39;Sem_5ago_11ago_2017.xls&#39;, &#39;Sem_6may_12may_2017.xls&#39;,
##        &#39;Sem_7ene_2017_13ene_2017.xls&#39;, &#39;Sem_7oct_13oct_2017.xls&#39;,
##        &#39;Sem_8abr_12abr_2017.xls&#39;, &#39;Sem_8jul_14jul_2017.xls&#39;,
##        &#39;Sem_9dic_15dic_2017.xls&#39;, &#39;Sem_9sep_15sep_2017.xls&#39;,
##        &#39;Sem_03mar__09mar_2018&#39;, &#39;Sem_05may__11may_2018&#39;,
##        &#39;Sem_07abr__13abr_2018&#39;, &#39;Sem_10feb_16feb_2018.xls&#39;,
##        &#39;Sem_10mar__16mar_2018&#39;, &#39;Sem_13ene_19ene_2018.xls&#39;,
##        &#39;Sem_14abr__20abr_2018&#39;, &#39;Sem_17feb_23feb_2018.xls&#39;,
##        &#39;Sem_17mar__23mar_2018&#39;, &#39;Sem_20ene_26ene_2018.xls&#39;,
##        &#39;Sem_21abr__27abr_2018&#39;, &#39;Sem_24feb__02mar_2018&#39;,
##        &#39;Sem_24mar__28mar_2018&#39;, &#39;Sem_27ene_2feb_2018.xls&#39;,
##        &#39;Sem_28abr__04may_2018&#39;, &#39;Sem_30dic_5ene_2018.xls&#39;,
##        &#39;Sem_31mar__06abr_2018&#39;, &#39;Sem_3feb_9feb_2018.xls&#39;,
##        &#39;Sem_6ene_12ene_2018.xls&#39;, &#39;Sem_01dic__07dic_2018&#39;,
##        &#39;Sem_01sep__07sep_2018&#39;, &#39;Sem_02jun__08jun_2018&#39;,
##        &#39;Sem_03nov__09nov_2018&#39;, &#39;Sem_04ago__10ago_2018&#39;,
##        &#39;Sem_06oct__12oct_2018&#39;, &#39;Sem_07jul__13jul_2018&#39;,
##        &#39;Sem_08dic__14dic_2018&#39;, &#39;Sem_08sep__14sep_2018&#39;,
##        &#39;Sem_09jun__15jun_2018&#39;, &#39;Sem_10nov__16nov_2018&#39;,
##        &#39;Sem_11ago__17ago_2018&#39;, &#39;Sem_12may__18may_2018_int&#39;,
##        &#39;Sem_13oct__19oct_2018&#39;, &#39;Sem_14jul__19jul_2018&#39;,
##        &#39;Sem_15dic__21dic_2018&#39;, &#39;Sem_15sep__21sep_2018&#39;,
##        &#39;Sem_16jun__22jun_2018&#39;, &#39;Sem_17nov__23nov_2018&#39;,
##        &#39;Sem_18ago__24ago_2018&#39;, &#39;Sem_19may__25may_2018&#39;,
##        &#39;Sem_20jul__27jul_2018&#39;, &#39;Sem_20oct__26oct_2018&#39;,
##        &#39;Sem_22dic__28dic_2018&#39;, &#39;Sem_22sep__28sep_2018&#39;,
##        &#39;Sem_23jun__29jun_2018&#39;, &#39;Sem_24nov__30nov_2018&#39;,
##        &#39;Sem_25ago__31ago_2018&#39;, &#39;Sem_26may__01jun_2018&#39;,
##        &#39;Sem_27oct__02nov_2018&#39;, &#39;Sem_28jul__03ago_2018&#39;,
##        &#39;Sem_29sep__05oct_2018&#39;, &#39;Sem_30jun__06jul_2018&#39;,
##        &#39;Sem_01jun_2019__07jun_2019&#39;, &#39;Sem_02feb_2019__08feb_2019&#39;,
##        &#39;Sem_02mar_2019__08mar_2019&#39;, &#39;Sem_02nov_2019__08nov_2019&#39;,
##        &#39;Sem_03ago_2019__09ago_2019&#39;, &#39;Sem_04may_2019__10may_2019&#39;,
##        &#39;Sem_05oct_2019__11oct_2019&#39;, &#39;Sem_06abr_2019__12abr_2019&#39;,
##        &#39;Sem_06jul_2019__12jul_2019&#39;, &#39;Sem_07dic_2019__13dic_2019&#39;,
##        &#39;Sem_07sep_2019__13sep_2019&#39;, &#39;Sem_08jun_2019__14jun_2019&#39;,
##        &#39;Sem_09feb_2019__15feb_2019&#39;, &#39;Sem_09mar_2019__15mar_2019&#39;,
##        &#39;Sem_09nov_2019__15nov_2019&#39;, &#39;Sem_10ago_2019__16ago_2019&#39;,
##        &#39;Sem_11may_2019__17may_2019&#39;, &#39;Sem_12ene_2019_18ene_2019&#39;,
##        &#39;Sem_12oct_2019__18oct_2019&#39;, &#39;Sem_13abr_2019__17abr_2019&#39;,
##        &#39;Sem_13jul_2019__19jul_2019&#39;, &#39;Sem_14dic_2019__20dic_2019&#39;,
##        &#39;Sem_14sep_2019__20sep_2019&#39;, &#39;Sem_15jun_2019__21jun_2019&#39;,
##        &#39;Sem_16feb_2019__22feb_2019&#39;, &#39;Sem_16mar_2019__22mar_2019&#39;,
##        &#39;Sem_16nov_2019__22nov_2019&#39;, &#39;Sem_17ago_2019__23ago_2019&#39;,
##        &#39;Sem_18may_2019_24may_2019&#39;, &#39;Sem_19ene_2019__25ene_2019&#39;,
##        &#39;Sem_19oct_2019__25oct_2019&#39;, &#39;Sem_20abr_2019__26abr_2019&#39;,
##        &#39;Sem_20jul_2019__26jul_2019&#39;, &#39;Sem_21dic_2019__27dic_2019&#39;,
##        &#39;Sem_21sep_2019__27sep_2019&#39;, &#39;Sem_22jun_2019__28jun_2019&#39;,
##        &#39;Sem_23feb_2019__01mar_2019&#39;, &#39;Sem_23mar_2019__29mar_2019&#39;,
##        &#39;Sem_23nov_2019__29nov_2019&#39;, &#39;Sem_24ago_2019__30ago_2019&#39;,
##        &#39;Sem_25may_2019__31may_2019&#39;, &#39;Sem_26ene_2019__01feb_2019&#39;,
##        &#39;Sem_26oct_2019__01nov_2019&#39;, &#39;Sem_27abr_2019__03may_2019&#39;,
##        &#39;Sem_27jul_2019__02ago_2019&#39;, &#39;Sem_28sep_2019__04oct_2019&#39;,
##        &#39;Sem_29dic_2018_4ene_2019&#39;, &#39;Sem_29jun_2019__05jul_2019&#39;,
##        &#39;Sem_30mar_2019__05abr_2019&#39;, &#39;Sem_30nov_2019__06dic_2019&#39;,
##        &#39;Sem_31ago_2019__06sep_2019&#39;, &#39;Sem_5ene_2019_11ene_2019&#39;,
##        &#39;Sem_01ago_2020__06ago_2020&#39;, &#39;Sem_01feb_2020__07feb_2020&#39;,
##        &#39;Sem_01may_2020__08may_2020&#39;, &#39;Sem_04abr_2020__08abr_2020&#39;,
##        &#39;Sem_04ene_2020__10ene_2020&#39;, &#39;Sem_04jul_2020__10jul_2020&#39;,
##        &#39;Sem_05dic_2020__11dic_2020&#39;, &#39;Sem_05oct_2020__090ct_2020&#39;,
##        &#39;Sem_05sep_2020__11sep_2020&#39;, &#39;Sem_06jun_2020__12jun_2020&#39;,
##        &#39;Sem_07ago_2020__14ago_2020&#39;, &#39;Sem_07mar_2020__13mar_2020&#39;,
##        &#39;Sem_07nov_2020__13nov_2020&#39;, &#39;Sem_08feb_2020__14feb_2020&#39;,
##        &#39;Sem_09may_2020__15may_2020&#39;, &#39;Sem_11abr_2020__17abr_2020&#39;,
##        &#39;Sem_11ene_2020__17ene_2020&#39;, &#39;Sem_11jul_2020__17jul_2020&#39;,
##        &#39;Sem_12dic_2020__18dic_2020&#39;, &#39;Sem_12oct_2020__16oct_2020&#39;,
##        &#39;Sem_12sep_2020__18sep_2020&#39;, &#39;Sem_13jun_2020__19jun_2020&#39;,
##        &#39;Sem_14mar_2020__20mar_2020&#39;, &#39;Sem_14nov_2020__20nov_2020&#39;,
##        &#39;Sem_15ago_2020__21ago_2020&#39;, &#39;Sem_15feb_2020__21feb_2020&#39;,
##        &#39;Sem_16may_2020__22may_2020&#39;, &#39;Sem_17oct_2020__23oct_2020&#39;,
##        &#39;Sem_18abr_2020__24abr_2020&#39;, &#39;Sem_18ene_2020__24ene_2020&#39;,
##        &#39;Sem_18jul_2020__24jul_2020&#39;, &#39;Sem_19dic_2020__24dic_2020&#39;,
##        &#39;Sem_19sep_2020__25sep_2020&#39;, &#39;Sem_20jun_2020__26jun_2020&#39;,
##        &#39;Sem_21mar_2020__27mar_2020&#39;, &#39;Sem_21nov_2020__27nov_2020&#39;,
##        &#39;Sem_22ago_2020__28ago_2020&#39;, &#39;Sem_22feb_2020__28feb_2020&#39;,
##        &#39;Sem_23may_2020__29may_2020&#39;, &#39;Sem_24oct_2020__30oct_2020&#39;,
##        &#39;Sem_25abr_2020__30abr_2020&#39;, &#39;Sem_25ene_2020__31ene_2020&#39;,
##        &#39;Sem_25jul_2020__31jul_2020&#39;, &#39;Sem_26dic_2020__31dic_2020&#39;,
##        &#39;Sem_26sep_2020__02oct_2020&#39;, &#39;Sem_27jun_2020__03jul_2020&#39;,
##        &#39;Sem_28dic_2019__03ene_2020&#39;, &#39;Sem_28mar_2020__03abr_2020&#39;,
##        &#39;Sem_28nov_2020__04dic_2020&#39;, &#39;Sem_29ago_2020__04sep_2020&#39;,
##        &#39;Sem_29feb_2020__06mar_2020&#39;, &#39;Sem_30may_2020__05jun_2020&#39;,
##        &#39;Sem_31oct_2020__06nov_2020&#39;, &#39;Sem_01may_2021_07may_2021.xls&#39;,
##        &#39;Sem_02ene_2021__08ene_2021&#39;, &#39;Sem_02oct_2021_08oct_2021.xls&#39;,
##        &#39;Sem_03abr_2021_09abr_2021.xls&#39;, &#39;Sem_03jul_2021_09jul_2021.xls&#39;,
##        &#39;Sem_04dic_2021__10dic_2021&#39;, &#39;Sem_04sep_2021_10sep_2021.xls&#39;,
##        &#39;Sem_05jun_2021_11jun_2021.xls&#39;, &#39;Sem_06feb_2021__12feb_2021&#39;,
##        &#39;Sem_06mar_2021_12mar_2021.xls&#39;, &#39;Sem_07ago_2021_13ago_2021.xls&#39;,
##        &#39;Sem_08may_2021_14may_2021.xls&#39;, &#39;Sem_09ene_2021__15ene_2021&#39;,
##        &#39;Sem_09oct_2021_15oct_2021.xls&#39;, &#39;Sem_10abr_2021_16abr_2021.xls&#39;,
##        &#39;Sem_10jul_2021_16jul_2021.xls&#39;, &#39;Sem_11dic_2021_17dic_2021&#39;,
##        &#39;Sem_11sep_2021_17sep_2021.xls&#39;, &#39;Sem_12jun_2021_18jun_2021.xls&#39;,
##        &#39;Sem_13feb_2021__19feb_2021&#39;, &#39;Sem_13mar_2021_19mar_2021.xls&#39;,
##        &#39;Sem_13nov_2021__19nov_2021&#39;, &#39;Sem_14ago_2021_20ago_2021.xls&#39;,
##        &#39;Sem_15may_2021_21may_2021.xls&#39;, &#39;Sem_16ene_2021__22ene_2021&#39;,
##        &#39;Sem_16oct_2021_22oct_2021.xls&#39;, &#39;Sem_17abr_2021_23abr_2021.xls&#39;,
##        &#39;Sem_17jul_2021_23jul_2021.xls&#39;, &#39;Sem_18dic_2021_24dic_2021&#39;,
##        &#39;Sem_18sep_2021_24sep_2021.xls&#39;, &#39;Sem_19jun_2021_25jun_2021.xls&#39;,
##        &#39;Sem_20feb_2021__26feb_2021&#39;, &#39;Sem_20mar_2021_26mar_2021.xls&#39;,
##        &#39;Sem_20nov_2021__26nov_2021&#39;, &#39;Sem_21ago_2021_27ago_2021.xls&#39;,
##        &#39;Sem_22may_2021_28may_2021.xls&#39;, &#39;Sem_23ene_2021__29ene_2021&#39;,
##        &#39;Sem_23oct_2021_29oct_2021.xls&#39;, &#39;Sem_24abr_2021_30abr_2021.xls&#39;,
##        &#39;Sem_24jul_2021_30jul_2021.xls&#39;, &#39;Sem_25dic_2021_31dic_2021&#39;,
##        &#39;Sem_25sep_2021_01oct_2021.xls&#39;, &#39;Sem_26jun_2021_02jul_2021.xls&#39;,
##        &#39;Sem_27feb_2021_05mar_2021&#39;, &#39;Sem_27mar_2021_31mar_2021.xls&#39;,
##        &#39;Sem_27nov_2021__03dic_2021&#39;, &#39;Sem_28ago_2021_03sep_2021.xls&#39;,
##        &#39;Sem_29may_2021_04jun_2021.xls&#39;, &#39;Sem_30ene_2021__05feb_2021&#39;,
##        &#39;Sem_30oct_2021__05nov_2021.xls&#39;, &#39;Sem_31jul_2021_06ago_2021.xls&#39;,
##        &#39;anex_01oct_al_07oct_2022&#39;, &#39;anex_02abr_al_08abr_2022&#39;,
##        &#39;anex_02jul_al_08jul_2022&#39;, &#39;anex_03sep_al_08sep_2022&#39;,
##        &#39;anex_04jun_al_10jun_2022&#39;, &#39;anex_05nov_al_11nov_2022&#39;,
##        &#39;anex_06ago_al_12ago_2022&#39;, &#39;anex_07may_al_13may_2022&#39;,
##        &#39;anex_08oct_al_14oct_2022&#39;, &#39;anex_09abr_al_13abr_2022&#39;,
##        &#39;anex_09jul_al_15jul_2022&#39;, &#39;anex_10dic_al_16dic_2022&#39;,
##        &#39;anex_10sep_al_16sep_2022&#39;, &#39;anex_11jun_al_17jun_2022&#39;,
##        &#39;Anex_12mar_al_18mar_2022&#39;, &#39;anex_12nov_al_18nov_2022&#39;,
##        &#39;anex_13ago_al_19ago_2022&#39;, &#39;anex_14may_al_20may_2022&#39;,
##        &#39;anex_15oct_al_21oct_2022 (1)&#39;, &#39;anex_15oct_al_21oct_2022&#39;,
##        &#39;anex_16abr_al_22abr_2022&#39;, &#39;anex_16jul_al_22jul_2022&#39;,
##        &#39;anex_17dic_al_23dic_2022&#39;, &#39;anex_17sep_al_23sep_2022&#39;,
##        &#39;anex_18jun_al_24jun_2022&#39;, &#39;anex_19mar_al_25mar_2022&#39;,
##        &#39;anex_19nov_al_25nov_2022&#39;, &#39;anex_20ago_al_26ago_2022&#39;,
##        &#39;anex_21may_al_27may_2022&#39;, &#39;anex_22oct_al_28oct_2022&#39;,
##        &#39;anex_23abr_al_29abr_2022&#39;, &#39;anex_23jul_al_29jul_2022&#39;,
##        &#39;anex_24dic_al_30dic_2022&#39;, &#39;anex_24sep_al_30sep_2022&#39;,
##        &#39;anex_25jun_al_01jul_2022&#39;, &#39;anex_26mar_al_01abr_2022&#39;,
##        &#39;anex_26nov_al_2dic_2022&#39;, &#39;anex_27ago_al_02sep_2022&#39;,
##        &#39;anex_28may_al_03jun_2022&#39;, &#39;anex_29oct_al_04nov_2022&#39;,
##        &#39;anex_30abr_al_06may_2022&#39;, &#39;anex_30jul_al_05ago_2022&#39;,
##        &#39;anex_31dic_al_06ene_2023&#39;, &#39;anex_3dic_al_9dic_2022&#39;,
##        &#39;Sem_01ene_2022_07ene_2022&#39;, &#39;Sem_05feb_2022_11feb_2022&#39;,
##        &#39;Sem_05mar_2022_11mar_2022&#39;, &#39;Sem_08ene_2022_14ene_2022&#39;,
##        &#39;Sem_12feb_2022_18feb_2022&#39;, &#39;Sem_15ene_2022_21ene_2022&#39;,
##        &#39;Sem_19feb_2022_25feb_2022&#39;, &#39;Sem_22ene_2022_28ene_2022&#39;,
##        &#39;Sem_26feb_2022_04mar_2022&#39;, &#39;Sem_29ene_2022_04feb_2022&#39;, nan],
##       dtype=object)</code></pre>
<p>Al observar el contenido de la columna se puede aprecicar lo siguiente:</p>
<ul>
<li><p>Hay cuatro tipos de codificación de semana:</p>
<ul>
<li>Sem_10sep_16sep_2016.xls -&gt; El elemento inicial es Sem y demarca los dias referenciando una vez el año, algunos aun contienen la extensión del archivo.</li>
<li>’Sem_02feb_2019__08feb_2019’ -&gt; El elemento inicial es Sem, en este caso el año se referencia dos veces cada vez que se referencia el dia de la semana.</li>
<li>‘anex_02abr_al_08abr_2022’ -&gt; Se cambia el término Sem por anex y nuevamente el año aparece solo una vez.</li>
<li>Sem_22sep__28sep_2018’ -&gt; caso similar al número 1 pero no cuenta con extensión.</li>
</ul></li>
<li><p>Adicionalmente se logra apreciar que las semanas se codifican de sábado a viernes teniendo inicio el sábado 02 de Enero de 2016 y finalizando el sábado 31 de 2022.</p></li>
<li><p>Hay diferentes carácteres a en los rangos establecidos lo cual implica aplicar varias operaciones de limpieza para llegar a extraer fechas.</p></li>
</ul>
<p>Dado que a partir de la revisión del listado de fechas se ha logrado establecer el rango del periodo semanal y tambien encontrar generalidades de los formatos a nivel de semana, se seguirá la siguiente estrategia de trasnformación:</p>
<ul>
<li>Se eliminarán los ceros a la izquierda.<br />
</li>
<li>Se eliminarán las extensiones de archivo y tambien se eliminarán componentes iniciales como las particulas “Sem”,“Anex”,“Al”,“int” con el fin de dejar unicamente fechas y años.</li>
<li>Se generará temporalmente una variable longitud con el fin de conocer la variabilidad de carácteres y orientar el proceso de limpieza.</li>
<li>Se cambiarán las iniciales de los meses por su respectivo número.</li>
<li>Se realizará un split por medio del simbolo de separación “_” con el fin de tener listas en la columna periodo que permitan extraer elementos particulares para estructurar fechas.</li>
<li>Se crearán funciones con elementos condicionales según la longitud del string con el fin de extraer la fecha inicial de la semana.</li>
</ul>
<p>Como primer paso se creará la función quitarcerosiniciales() la cual tendrá como objetivo remover los ceros a la izquierda que existan en los nombres de la columna:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb35-1" tabindex="-1"></a></span>
<span id="cb35-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb35-2" tabindex="-1"></a><span class="kw">def</span> quitarcerosiniciales(string):</span>
<span id="cb35-3"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb35-3" tabindex="-1"></a>    </span>
<span id="cb35-4"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb35-4" tabindex="-1"></a>    regex<span class="op">=</span> <span class="st">&quot;^0+(?!$)&quot;</span></span>
<span id="cb35-5"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb35-5" tabindex="-1"></a>    string_salida<span class="op">=</span> re.sub(regex,<span class="st">&quot;&quot;</span>,string)</span>
<span id="cb35-6"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb35-6" tabindex="-1"></a>    </span>
<span id="cb35-7"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb35-7" tabindex="-1"></a>    <span class="cf">return</span> string_salida</span></code></pre></div>
<p>Seguidamente con la función anteriormente creada se aplicarán operaciones con funciones tipo lambda para remover partes de los strings de la columna que no sean relevantes para la extracción de la fecha:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb36-1" tabindex="-1"></a></span>
<span id="cb36-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb36-2" tabindex="-1"></a>df_sipsa[<span class="st">&quot;periodo&quot;</span>]<span class="op">=</span> df_sipsa[<span class="st">&quot;periodo&quot;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x:<span class="bu">str</span>(x).replace(<span class="st">&quot;.xls&quot;</span>,<span class="st">&quot;&quot;</span>).replace(<span class="st">&quot;.xlsx&quot;</span>,<span class="st">&quot;&quot;</span>).replace(<span class="st">&quot;__&quot;</span>,<span class="st">&quot;_&quot;</span>).replace(<span class="st">&quot;Sem_&quot;</span>,<span class="st">&quot;&quot;</span>).replace(<span class="st">&quot;anex_&quot;</span>,<span class="st">&quot;&quot;</span>).replace(<span class="st">&quot;Anex_&quot;</span>,<span class="st">&quot;&quot;</span>).replace(<span class="st">&quot; (1)&quot;</span>,<span class="st">&quot;&quot;</span>).replace(<span class="st">&quot;_int&quot;</span>,<span class="st">&quot;&quot;</span>).replace(<span class="st">&quot;_al&quot;</span>,<span class="st">&quot;&quot;</span>))</span>
<span id="cb36-3"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb36-3" tabindex="-1"></a></span>
<span id="cb36-4"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb36-4" tabindex="-1"></a>df_sipsa[<span class="st">&quot;periodo&quot;</span>]<span class="op">=</span>df_sipsa[<span class="st">&quot;periodo&quot;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x:quitarcerosiniciales(x))</span>
<span id="cb36-5"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb36-5" tabindex="-1"></a></span>
<span id="cb36-6"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb36-6" tabindex="-1"></a>df_sipsa<span class="op">=</span> df_sipsa[df_sipsa[<span class="st">&quot;periodo&quot;</span>]<span class="op">!=</span><span class="st">&quot;nan&quot;</span>]</span></code></pre></div>
<p>Al aplicar estas operaciones los registros de la columna periodo se ven de la siguiente manera:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb37-1" tabindex="-1"></a></span>
<span id="cb37-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb37-2" tabindex="-1"></a>df_sipsa[<span class="st">&quot;periodo&quot;</span>].unique()</span></code></pre></div>
<pre><code>## array([&#39;10dic_16dic_2016&#39;, &#39;10sep_16sep_2016&#39;, &#39;11jun_17jun_2016&#39;,
##        &#39;12mar_18mar_2016&#39;, &#39;12nov_18nov_2016&#39;, &#39;13ago_19ago_2016&#39;,
##        &#39;13feb_19feb_2016&#39;, &#39;14may_20may_2016&#39;, &#39;15oct_21oct_2016&#39;,
##        &#39;16abr_22abr_2016&#39;, &#39;16ene_22ene_2016&#39;, &#39;16jul_22jul_2016&#39;,
##        &#39;17dic_23dic_2016&#39;, &#39;17sep_23sept_2016&#39;, &#39;18jun_24jun_2016&#39;,
##        &#39;19mar_23mar_2016&#39;, &#39;19nov_25nov_2016&#39;, &#39;1oct_7oct_2016&#39;,
##        &#39;20ago_26ago_2016&#39;, &#39;20feb_26feb_2016&#39;, &#39;21may_27may_2016&#39;,
##        &#39;22oct_28oct_2016&#39;, &#39;23abr_29abr_2016&#39;, &#39;23ene_29ene_2016&#39;,
##        &#39;23jul_29jul_2016&#39;, &#39;24dic_30dic_2016&#39;, &#39;24jun_1jul_2016&#39;,
##        &#39;24sep_30sep_2016&#39;, &#39;26mar_1abr_2016&#39;, &#39;26nov_2dic_2016&#39;,
##        &#39;27ago_2sep_2016&#39;, &#39;27feb_4mar_2016&#39;, &#39;28may_3jun_2016&#39;,
##        &#39;29oct_04nov_2016&#39;, &#39;2abr_8abr_2016&#39;, &#39;2ene_8ene_2016&#39;,
##        &#39;2jul_8jul_2016&#39;, &#39;30abr_06may_2016&#39;, &#39;30ene_5feb_2016&#39;,
##        &#39;30jul_5ago_2016&#39;, &#39;3dic_9dic_2016&#39;, &#39;3sep_9sep_2016&#39;,
##        &#39;4jun_10jun_2016&#39;, &#39;5mar_11mar_2016&#39;, &#39;5nov_11nov_2016&#39;,
##        &#39;6ago_12ago_2016&#39;, &#39;6feb_12feb_2016&#39;, &#39;7may_13may_2016&#39;,
##        &#39;8oct_14oct_2016&#39;, &#39;9abr_15abr_2016&#39;, &#39;9ene_15ene_2016&#39;,
##        &#39;9jul_15jul_2016&#39;, &#39;10jun_16jun_2017&#39;, &#39;11feb_17feb_2017&#39;,
##        &#39;11mar_17mar_2017&#39;, &#39;11nov_17nov_2017&#39;, &#39;12ago_18ago_2017&#39;,
##        &#39;13abr_21abr_2017&#39;, &#39;13may_19may_2017&#39;, &#39;14ene_2017_20ene_2017&#39;,
##        &#39;14oct_2017_20oct_2017&#39;, &#39;15jul_21jul_2017&#39;, &#39;16dic_22dic_2017&#39;,
##        &#39;16sep_22sep_2017&#39;, &#39;17jun_23jun_2017&#39;, &#39;18feb_24feb_2017&#39;,
##        &#39;18mar_24mar_2016&#39;, &#39;18nov_24nov_2017&#39;, &#39;19ago_25ago_2017&#39;,
##        &#39;1abr_7abr_2017&#39;, &#39;1jul_7jul_2017&#39;, &#39;20may_26may_2017&#39;,
##        &#39;21ene_27ene_2017&#39;, &#39;21oct_27oct_2017&#39;, &#39;22abr_28abr_2017&#39;,
##        &#39;22jul_28jul_2017&#39;, &#39;23dic_29dic_2017&#39;, &#39;23sep_29sep_2017&#39;,
##        &#39;24jun_30jun_2017&#39;, &#39;25feb_3mar_2017&#39;, &#39;25mar_31mar_2017&#39;,
##        &#39;25nov_1dic_2017&#39;, &#39;26ago_1sep_2017&#39;, &#39;27may_2jun_2017&#39;,
##        &#39;28ene_3feb_2017&#39;, &#39;28oct_3nov_2017&#39;, &#39;29abr_5may_2017&#39;,
##        &#39;29jul_4ago_2017&#39;, &#39;2dic_7dic_2017&#39;, &#39;2sep_8sep_2017&#39;,
##        &#39;30sep_6oct_2017&#39;, &#39;31dic_2016_6ene_2017&#39;, &#39;3jun_9jun_2017&#39;,
##        &#39;4feb_10feb_2017&#39;, &#39;4mar_10mar_2017&#39;, &#39;4nov_2017_10nov_2017&#39;,
##        &#39;5ago_11ago_2017&#39;, &#39;6may_12may_2017&#39;, &#39;7ene_2017_13ene_2017&#39;,
##        &#39;7oct_13oct_2017&#39;, &#39;8abr_12abr_2017&#39;, &#39;8jul_14jul_2017&#39;,
##        &#39;9dic_15dic_2017&#39;, &#39;9sep_15sep_2017&#39;, &#39;3mar_09mar_2018&#39;,
##        &#39;5may_11may_2018&#39;, &#39;7abr_13abr_2018&#39;, &#39;10feb_16feb_2018&#39;,
##        &#39;10mar_16mar_2018&#39;, &#39;13ene_19ene_2018&#39;, &#39;14abr_20abr_2018&#39;,
##        &#39;17feb_23feb_2018&#39;, &#39;17mar_23mar_2018&#39;, &#39;20ene_26ene_2018&#39;,
##        &#39;21abr_27abr_2018&#39;, &#39;24feb_02mar_2018&#39;, &#39;24mar_28mar_2018&#39;,
##        &#39;27ene_2feb_2018&#39;, &#39;28abr_04may_2018&#39;, &#39;30dic_5ene_2018&#39;,
##        &#39;31mar_06abr_2018&#39;, &#39;3feb_9feb_2018&#39;, &#39;6ene_12ene_2018&#39;,
##        &#39;1dic_07dic_2018&#39;, &#39;1sep_07sep_2018&#39;, &#39;2jun_08jun_2018&#39;,
##        &#39;3nov_09nov_2018&#39;, &#39;4ago_10ago_2018&#39;, &#39;6oct_12oct_2018&#39;,
##        &#39;7jul_13jul_2018&#39;, &#39;8dic_14dic_2018&#39;, &#39;8sep_14sep_2018&#39;,
##        &#39;9jun_15jun_2018&#39;, &#39;10nov_16nov_2018&#39;, &#39;11ago_17ago_2018&#39;,
##        &#39;12may_18may_2018&#39;, &#39;13oct_19oct_2018&#39;, &#39;14jul_19jul_2018&#39;,
##        &#39;15dic_21dic_2018&#39;, &#39;15sep_21sep_2018&#39;, &#39;16jun_22jun_2018&#39;,
##        &#39;17nov_23nov_2018&#39;, &#39;18ago_24ago_2018&#39;, &#39;19may_25may_2018&#39;,
##        &#39;20jul_27jul_2018&#39;, &#39;20oct_26oct_2018&#39;, &#39;22dic_28dic_2018&#39;,
##        &#39;22sep_28sep_2018&#39;, &#39;23jun_29jun_2018&#39;, &#39;24nov_30nov_2018&#39;,
##        &#39;25ago_31ago_2018&#39;, &#39;26may_01jun_2018&#39;, &#39;27oct_02nov_2018&#39;,
##        &#39;28jul_03ago_2018&#39;, &#39;29sep_05oct_2018&#39;, &#39;30jun_06jul_2018&#39;,
##        &#39;1jun_2019_07jun_2019&#39;, &#39;2feb_2019_08feb_2019&#39;,
##        &#39;2mar_2019_08mar_2019&#39;, &#39;2nov_2019_08nov_2019&#39;,
##        &#39;3ago_2019_09ago_2019&#39;, &#39;4may_2019_10may_2019&#39;,
##        &#39;5oct_2019_11oct_2019&#39;, &#39;6abr_2019_12abr_2019&#39;,
##        &#39;6jul_2019_12jul_2019&#39;, &#39;7dic_2019_13dic_2019&#39;,
##        &#39;7sep_2019_13sep_2019&#39;, &#39;8jun_2019_14jun_2019&#39;,
##        &#39;9feb_2019_15feb_2019&#39;, &#39;9mar_2019_15mar_2019&#39;,
##        &#39;9nov_2019_15nov_2019&#39;, &#39;10ago_2019_16ago_2019&#39;,
##        &#39;11may_2019_17may_2019&#39;, &#39;12ene_2019_18ene_2019&#39;,
##        &#39;12oct_2019_18oct_2019&#39;, &#39;13abr_2019_17abr_2019&#39;,
##        &#39;13jul_2019_19jul_2019&#39;, &#39;14dic_2019_20dic_2019&#39;,
##        &#39;14sep_2019_20sep_2019&#39;, &#39;15jun_2019_21jun_2019&#39;,
##        &#39;16feb_2019_22feb_2019&#39;, &#39;16mar_2019_22mar_2019&#39;,
##        &#39;16nov_2019_22nov_2019&#39;, &#39;17ago_2019_23ago_2019&#39;,
##        &#39;18may_2019_24may_2019&#39;, &#39;19ene_2019_25ene_2019&#39;,
##        &#39;19oct_2019_25oct_2019&#39;, &#39;20abr_2019_26abr_2019&#39;,
##        &#39;20jul_2019_26jul_2019&#39;, &#39;21dic_2019_27dic_2019&#39;,
##        &#39;21sep_2019_27sep_2019&#39;, &#39;22jun_2019_28jun_2019&#39;,
##        &#39;23feb_2019_01mar_2019&#39;, &#39;23mar_2019_29mar_2019&#39;,
##        &#39;23nov_2019_29nov_2019&#39;, &#39;24ago_2019_30ago_2019&#39;,
##        &#39;25may_2019_31may_2019&#39;, &#39;26ene_2019_01feb_2019&#39;,
##        &#39;26oct_2019_01nov_2019&#39;, &#39;27abr_2019_03may_2019&#39;,
##        &#39;27jul_2019_02ago_2019&#39;, &#39;28sep_2019_04oct_2019&#39;,
##        &#39;29dic_2018_4ene_2019&#39;, &#39;29jun_2019_05jul_2019&#39;,
##        &#39;30mar_2019_05abr_2019&#39;, &#39;30nov_2019_06dic_2019&#39;,
##        &#39;31ago_2019_06sep_2019&#39;, &#39;5ene_2019_11ene_2019&#39;,
##        &#39;1ago_2020_06ago_2020&#39;, &#39;1feb_2020_07feb_2020&#39;,
##        &#39;1may_2020_08may_2020&#39;, &#39;4abr_2020_08abr_2020&#39;,
##        &#39;4ene_2020_10ene_2020&#39;, &#39;4jul_2020_10jul_2020&#39;,
##        &#39;5dic_2020_11dic_2020&#39;, &#39;5oct_2020_090ct_2020&#39;,
##        &#39;5sep_2020_11sep_2020&#39;, &#39;6jun_2020_12jun_2020&#39;,
##        &#39;7ago_2020_14ago_2020&#39;, &#39;7mar_2020_13mar_2020&#39;,
##        &#39;7nov_2020_13nov_2020&#39;, &#39;8feb_2020_14feb_2020&#39;,
##        &#39;9may_2020_15may_2020&#39;, &#39;11abr_2020_17abr_2020&#39;,
##        &#39;11ene_2020_17ene_2020&#39;, &#39;11jul_2020_17jul_2020&#39;,
##        &#39;12dic_2020_18dic_2020&#39;, &#39;12oct_2020_16oct_2020&#39;,
##        &#39;12sep_2020_18sep_2020&#39;, &#39;13jun_2020_19jun_2020&#39;,
##        &#39;14mar_2020_20mar_2020&#39;, &#39;14nov_2020_20nov_2020&#39;,
##        &#39;15ago_2020_21ago_2020&#39;, &#39;15feb_2020_21feb_2020&#39;,
##        &#39;16may_2020_22may_2020&#39;, &#39;17oct_2020_23oct_2020&#39;,
##        &#39;18abr_2020_24abr_2020&#39;, &#39;18ene_2020_24ene_2020&#39;,
##        &#39;18jul_2020_24jul_2020&#39;, &#39;19dic_2020_24dic_2020&#39;,
##        &#39;19sep_2020_25sep_2020&#39;, &#39;20jun_2020_26jun_2020&#39;,
##        &#39;21mar_2020_27mar_2020&#39;, &#39;21nov_2020_27nov_2020&#39;,
##        &#39;22ago_2020_28ago_2020&#39;, &#39;22feb_2020_28feb_2020&#39;,
##        &#39;23may_2020_29may_2020&#39;, &#39;24oct_2020_30oct_2020&#39;,
##        &#39;25abr_2020_30abr_2020&#39;, &#39;25ene_2020_31ene_2020&#39;,
##        &#39;25jul_2020_31jul_2020&#39;, &#39;26dic_2020_31dic_2020&#39;,
##        &#39;26sep_2020_02oct_2020&#39;, &#39;27jun_2020_03jul_2020&#39;,
##        &#39;28dic_2019_03ene_2020&#39;, &#39;28mar_2020_03abr_2020&#39;,
##        &#39;28nov_2020_04dic_2020&#39;, &#39;29ago_2020_04sep_2020&#39;,
##        &#39;29feb_2020_06mar_2020&#39;, &#39;30may_2020_05jun_2020&#39;,
##        &#39;31oct_2020_06nov_2020&#39;, &#39;1may_2021_07may_2021&#39;,
##        &#39;2ene_2021_08ene_2021&#39;, &#39;2oct_2021_08oct_2021&#39;,
##        &#39;3abr_2021_09abr_2021&#39;, &#39;3jul_2021_09jul_2021&#39;,
##        &#39;4dic_2021_10dic_2021&#39;, &#39;4sep_2021_10sep_2021&#39;,
##        &#39;5jun_2021_11jun_2021&#39;, &#39;6feb_2021_12feb_2021&#39;,
##        &#39;6mar_2021_12mar_2021&#39;, &#39;7ago_2021_13ago_2021&#39;,
##        &#39;8may_2021_14may_2021&#39;, &#39;9ene_2021_15ene_2021&#39;,
##        &#39;9oct_2021_15oct_2021&#39;, &#39;10abr_2021_16abr_2021&#39;,
##        &#39;10jul_2021_16jul_2021&#39;, &#39;11dic_2021_17dic_2021&#39;,
##        &#39;11sep_2021_17sep_2021&#39;, &#39;12jun_2021_18jun_2021&#39;,
##        &#39;13feb_2021_19feb_2021&#39;, &#39;13mar_2021_19mar_2021&#39;,
##        &#39;13nov_2021_19nov_2021&#39;, &#39;14ago_2021_20ago_2021&#39;,
##        &#39;15may_2021_21may_2021&#39;, &#39;16ene_2021_22ene_2021&#39;,
##        &#39;16oct_2021_22oct_2021&#39;, &#39;17abr_2021_23abr_2021&#39;,
##        &#39;17jul_2021_23jul_2021&#39;, &#39;18dic_2021_24dic_2021&#39;,
##        &#39;18sep_2021_24sep_2021&#39;, &#39;19jun_2021_25jun_2021&#39;,
##        &#39;20feb_2021_26feb_2021&#39;, &#39;20mar_2021_26mar_2021&#39;,
##        &#39;20nov_2021_26nov_2021&#39;, &#39;21ago_2021_27ago_2021&#39;,
##        &#39;22may_2021_28may_2021&#39;, &#39;23ene_2021_29ene_2021&#39;,
##        &#39;23oct_2021_29oct_2021&#39;, &#39;24abr_2021_30abr_2021&#39;,
##        &#39;24jul_2021_30jul_2021&#39;, &#39;25dic_2021_31dic_2021&#39;,
##        &#39;25sep_2021_01oct_2021&#39;, &#39;26jun_2021_02jul_2021&#39;,
##        &#39;27feb_2021_05mar_2021&#39;, &#39;27mar_2021_31mar_2021&#39;,
##        &#39;27nov_2021_03dic_2021&#39;, &#39;28ago_2021_03sep_2021&#39;,
##        &#39;29may_2021_04jun_2021&#39;, &#39;30ene_2021_05feb_2021&#39;,
##        &#39;30oct_2021_05nov_2021&#39;, &#39;31jul_2021_06ago_2021&#39;,
##        &#39;1oct_07oct_2022&#39;, &#39;2abr_08abr_2022&#39;, &#39;2jul_08jul_2022&#39;,
##        &#39;3sep_08sep_2022&#39;, &#39;4jun_10jun_2022&#39;, &#39;5nov_11nov_2022&#39;,
##        &#39;6ago_12ago_2022&#39;, &#39;7may_13may_2022&#39;, &#39;8oct_14oct_2022&#39;,
##        &#39;9abr_13abr_2022&#39;, &#39;9jul_15jul_2022&#39;, &#39;10dic_16dic_2022&#39;,
##        &#39;10sep_16sep_2022&#39;, &#39;11jun_17jun_2022&#39;, &#39;12mar_18mar_2022&#39;,
##        &#39;12nov_18nov_2022&#39;, &#39;13ago_19ago_2022&#39;, &#39;14may_20may_2022&#39;,
##        &#39;15oct_21oct_2022&#39;, &#39;16abr_22abr_2022&#39;, &#39;16jul_22jul_2022&#39;,
##        &#39;17dic_23dic_2022&#39;, &#39;17sep_23sep_2022&#39;, &#39;18jun_24jun_2022&#39;,
##        &#39;19mar_25mar_2022&#39;, &#39;19nov_25nov_2022&#39;, &#39;20ago_26ago_2022&#39;,
##        &#39;21may_27may_2022&#39;, &#39;22oct_28oct_2022&#39;, &#39;23abr_29abr_2022&#39;,
##        &#39;23jul_29jul_2022&#39;, &#39;24dic_30dic_2022&#39;, &#39;24sep_30sep_2022&#39;,
##        &#39;25jun_01jul_2022&#39;, &#39;26mar_01abr_2022&#39;, &#39;26nov_2dic_2022&#39;,
##        &#39;27ago_02sep_2022&#39;, &#39;28may_03jun_2022&#39;, &#39;29oct_04nov_2022&#39;,
##        &#39;30abr_06may_2022&#39;, &#39;30jul_05ago_2022&#39;, &#39;31dic_06ene_2023&#39;,
##        &#39;3dic_9dic_2022&#39;, &#39;1ene_2022_07ene_2022&#39;, &#39;5feb_2022_11feb_2022&#39;,
##        &#39;5mar_2022_11mar_2022&#39;, &#39;8ene_2022_14ene_2022&#39;,
##        &#39;12feb_2022_18feb_2022&#39;, &#39;15ene_2022_21ene_2022&#39;,
##        &#39;19feb_2022_25feb_2022&#39;, &#39;22ene_2022_28ene_2022&#39;,
##        &#39;26feb_2022_04mar_2022&#39;, &#39;29ene_2022_04feb_2022&#39;], dtype=object)</code></pre>
<p>Ahora el formato de los strings de periodo tienen un aspecto mucho más regular que permite realizar un trabajo más preciso para la extracción de fecha; para conocer que tan variados son los strings se crea una columna provisional denominada “longitud” la cual contiene el número de carácteres que tienen los strings de la columna:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb39-1" tabindex="-1"></a></span>
<span id="cb39-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb39-2" tabindex="-1"></a>df_sipsa[<span class="st">&quot;longitud&quot;</span>]<span class="op">=</span> df_sipsa[<span class="st">&quot;periodo&quot;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x:<span class="bu">len</span>(x))</span>
<span id="cb39-3"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb39-3" tabindex="-1"></a>df_sipsa[<span class="st">&quot;longitud&quot;</span>].value_counts()</span></code></pre></div>
<pre><code>## 16    535823
## 21    527565
## 15    293397
## 20    236411
## 14     60152
## 17      4645
## Name: longitud, dtype: int64</code></pre>
<p>Aun hay una variedad importante de strings no obstante como se reviso con anterioridad el formato ahora solo contiene referencias de fechas y separadores de guion bajo, con el fin de no tener que manejar “textos” para el formateo de las fechas en las siguiente lineas de código se reemplaza el texto corto de los meses [ejemplo: “ene”,“feb”, etc..] por su forma númerica, seguidamente se eliminan otros simbolos que podrian interferir:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb41-1" tabindex="-1"></a></span>
<span id="cb41-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb41-2" tabindex="-1"></a>df_sipsa[<span class="st">&quot;periodo&quot;</span>]<span class="op">=</span> df_sipsa[<span class="st">&quot;periodo&quot;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x:x.replace(<span class="st">&quot;ene&quot;</span>,<span class="st">&quot;01&quot;</span>)<span class="op">\</span></span>
<span id="cb41-3"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb41-3" tabindex="-1"></a>                                              .replace(<span class="st">&quot;feb&quot;</span>,<span class="st">&quot;02&quot;</span>).replace(<span class="st">&quot;mar&quot;</span>,<span class="st">&quot;03&quot;</span>)<span class="op">\</span></span>
<span id="cb41-4"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb41-4" tabindex="-1"></a>                                              .replace(<span class="st">&quot;abr&quot;</span>,<span class="st">&quot;04&quot;</span>).replace(<span class="st">&quot;may&quot;</span>,<span class="st">&quot;05&quot;</span>)<span class="op">\</span></span>
<span id="cb41-5"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb41-5" tabindex="-1"></a>                                              .replace(<span class="st">&quot;jun&quot;</span>,<span class="st">&quot;06&quot;</span>).replace(<span class="st">&quot;jul&quot;</span>,<span class="st">&quot;07&quot;</span>)<span class="op">\</span></span>
<span id="cb41-6"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb41-6" tabindex="-1"></a>                                              .replace(<span class="st">&quot;ago&quot;</span>,<span class="st">&quot;08&quot;</span>).replace(<span class="st">&quot;sep&quot;</span>,<span class="st">&quot;09&quot;</span>)<span class="op">\</span></span>
<span id="cb41-7"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb41-7" tabindex="-1"></a>                                              .replace(<span class="st">&quot;oct&quot;</span>,<span class="st">&quot;10&quot;</span>).replace(<span class="st">&quot;nov&quot;</span>,<span class="st">&quot;11&quot;</span>)<span class="op">\</span></span>
<span id="cb41-8"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb41-8" tabindex="-1"></a>                                              .replace(<span class="st">&quot;dic&quot;</span>,<span class="st">&quot;12&quot;</span>).replace(<span class="st">&quot;-&quot;</span>,<span class="st">&quot;&quot;</span>).replace(<span class="st">&quot;t&quot;</span>,<span class="st">&quot;&quot;</span>))</span>
<span id="cb41-9"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb41-9" tabindex="-1"></a></span>
<span id="cb41-10"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb41-10" tabindex="-1"></a><span class="bu">print</span>(df_sipsa[<span class="st">&quot;longitud&quot;</span>].value_counts(),<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 16    535823
## 21    527565
## 15    293397
## 20    236411
## 14     60152
## 17      4645
## Name: longitud, dtype: int64</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb43-1" tabindex="-1"></a><span class="bu">print</span>(df_sipsa[df_sipsa[<span class="st">&quot;longitud&quot;</span>]<span class="op">==</span><span class="dv">14</span>][<span class="st">&quot;periodo&quot;</span>][<span class="dv">0</span>:<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## 78986    110_710_2016
## Name: periodo, dtype: object</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb45-1" tabindex="-1"></a><span class="bu">print</span>(df_sipsa[df_sipsa[<span class="st">&quot;longitud&quot;</span>]<span class="op">==</span><span class="dv">15</span>][<span class="st">&quot;periodo&quot;</span>][<span class="dv">0</span>:<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## 120876    2406_107_2016
## Name: periodo, dtype: object</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb47-1" tabindex="-1"></a><span class="bu">print</span>(df_sipsa[df_sipsa[<span class="st">&quot;longitud&quot;</span>]<span class="op">==</span><span class="dv">16</span>][<span class="st">&quot;periodo&quot;</span>][<span class="dv">0</span>:<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## 0    1012_1612_2016
## Name: periodo, dtype: object</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb49-1" tabindex="-1"></a><span class="bu">print</span>(df_sipsa[df_sipsa[<span class="st">&quot;longitud&quot;</span>]<span class="op">==</span><span class="dv">17</span>][<span class="st">&quot;periodo&quot;</span>][<span class="dv">0</span>:<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## 60380    1709_2309_2016
## Name: periodo, dtype: object</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb51-1" tabindex="-1"></a><span class="bu">print</span>(df_sipsa[df_sipsa[<span class="st">&quot;longitud&quot;</span>]<span class="op">==</span><span class="dv">20</span>][<span class="st">&quot;periodo&quot;</span>][<span class="dv">0</span>:<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## 422874    3112_2016_601_2017
## Name: periodo, dtype: object</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb53-1" tabindex="-1"></a><span class="bu">print</span>(df_sipsa[df_sipsa[<span class="st">&quot;longitud&quot;</span>]<span class="op">==</span><span class="dv">21</span>][<span class="st">&quot;periodo&quot;</span>][<span class="dv">0</span>:<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## 273348    1401_2017_2001_2017
## Name: periodo, dtype: object</code></pre>
<p>El procesamiento ha sido efectivo, ahora el string solo esta conformado por números y guiones, esto tambien permite evidenciar que las fechas están expresadas de diferentes maneras, por ende en algunos casos la longitud es variable y da lugar a los casos que se listan en el código anteriormente ejecutado.<br />
El hecho lograr el formato que solo tiene números y guiones bajos permite realizar una separación a través de un split que genere listas que independicen cada término de la información de fecha:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb55-1" tabindex="-1"></a></span>
<span id="cb55-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb55-2" tabindex="-1"></a>df_sipsa[<span class="st">&quot;periodo&quot;</span>] <span class="op">=</span> df_sipsa[<span class="st">&quot;periodo&quot;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x:x.split(<span class="st">&quot;_&quot;</span>))</span></code></pre></div>
<p>El nuevo aspecto de los registros en la columna “periodo” es el siguiente:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb56-1" tabindex="-1"></a></span>
<span id="cb56-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb56-2" tabindex="-1"></a>df_sipsa[<span class="st">&quot;periodo&quot;</span>].head()</span></code></pre></div>
<pre><code>## 0    [1012, 1612, 2016]
## 1    [1012, 1612, 2016]
## 2    [1012, 1612, 2016]
## 3    [1012, 1612, 2016]
## 4    [1012, 1612, 2016]
## Name: periodo, dtype: object</code></pre>
<p>Al llegar a este nivel de procesamiento se puede apreciar claramente una diferenciación entre elementos como el año, el mes y el dia, dado que se conoce a priori que los datos tienen una frecuencia de generación semanal, resulta práctico tomar solo un dia como referencia de la semana esto permite que solo sea necesario procesar el primer término de las listas para obtener la fecha, siguiendo esta premisa se crea la función weekstart_conversor() que toma una lista de la columna periodo y realiza operaciones de slicing con el fin de obtener componentes relevantes para conocer la fecha a la cual se hace referencia:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-1" tabindex="-1"></a></span>
<span id="cb58-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-2" tabindex="-1"></a><span class="kw">def</span> weekstart_conversor(columna_periodo):</span>
<span id="cb58-3"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-3" tabindex="-1"></a>    </span>
<span id="cb58-4"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-4" tabindex="-1"></a>    longitud_lista<span class="op">=</span> <span class="bu">len</span>(columna_periodo)</span>
<span id="cb58-5"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-5" tabindex="-1"></a>    longitud_primer_elemento<span class="op">=</span> <span class="va">None</span></span>
<span id="cb58-6"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-6" tabindex="-1"></a>    </span>
<span id="cb58-7"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-7" tabindex="-1"></a>    <span class="cf">if</span> longitud_lista<span class="op">==</span><span class="dv">3</span>:</span>
<span id="cb58-8"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-8" tabindex="-1"></a>        primer_elemento<span class="op">=</span> columna_periodo[<span class="dv">0</span>]</span>
<span id="cb58-9"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-9" tabindex="-1"></a>        anio<span class="op">=</span> columna_periodo[<span class="dv">2</span>]</span>
<span id="cb58-10"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-10" tabindex="-1"></a>        longitud_primer_elemento<span class="op">=</span> <span class="bu">len</span>(primer_elemento)</span>
<span id="cb58-11"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-11" tabindex="-1"></a>        </span>
<span id="cb58-12"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-12" tabindex="-1"></a>        <span class="cf">if</span> longitud_primer_elemento<span class="op">==</span><span class="dv">3</span>:</span>
<span id="cb58-13"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-13" tabindex="-1"></a>            primer_elemento<span class="op">=</span> <span class="st">&quot;0&quot;</span><span class="op">+</span>primer_elemento</span>
<span id="cb58-14"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-14" tabindex="-1"></a>            dia<span class="op">=</span> primer_elemento[<span class="dv">0</span>:<span class="dv">2</span>]</span>
<span id="cb58-15"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-15" tabindex="-1"></a>            mes<span class="op">=</span> primer_elemento[<span class="dv">2</span>:<span class="dv">4</span>]</span>
<span id="cb58-16"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-16" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb58-17"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-17" tabindex="-1"></a>            dia<span class="op">=</span> primer_elemento[<span class="dv">0</span>:<span class="dv">2</span>]</span>
<span id="cb58-18"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-18" tabindex="-1"></a>            mes<span class="op">=</span> primer_elemento[<span class="dv">2</span>:<span class="dv">4</span>]</span>
<span id="cb58-19"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-19" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb58-20"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-20" tabindex="-1"></a>        primer_elemento<span class="op">=</span>columna_periodo[<span class="dv">0</span>]</span>
<span id="cb58-21"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-21" tabindex="-1"></a>        anio<span class="op">=</span> columna_periodo[<span class="dv">1</span>]</span>
<span id="cb58-22"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-22" tabindex="-1"></a>        longitud_primer_elemento<span class="op">=</span><span class="bu">len</span>(primer_elemento)</span>
<span id="cb58-23"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-23" tabindex="-1"></a>        </span>
<span id="cb58-24"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-24" tabindex="-1"></a>        <span class="cf">if</span> longitud_primer_elemento<span class="op">==</span><span class="dv">3</span>:</span>
<span id="cb58-25"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-25" tabindex="-1"></a>            primer_elemento<span class="op">=</span> <span class="st">&quot;0&quot;</span><span class="op">+</span>primer_elemento</span>
<span id="cb58-26"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-26" tabindex="-1"></a>            dia<span class="op">=</span> primer_elemento[<span class="dv">0</span>:<span class="dv">2</span>]</span>
<span id="cb58-27"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-27" tabindex="-1"></a>            mes<span class="op">=</span> primer_elemento[<span class="dv">2</span>:<span class="dv">4</span>]   </span>
<span id="cb58-28"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-28" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb58-29"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-29" tabindex="-1"></a>            dia<span class="op">=</span> primer_elemento[<span class="dv">0</span>:<span class="dv">2</span>]</span>
<span id="cb58-30"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-30" tabindex="-1"></a>            mes<span class="op">=</span> primer_elemento[<span class="dv">2</span>:<span class="dv">4</span>]</span>
<span id="cb58-31"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-31" tabindex="-1"></a>            </span>
<span id="cb58-32"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-32" tabindex="-1"></a>    </span>
<span id="cb58-33"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-33" tabindex="-1"></a>    week_start<span class="op">=</span> dia<span class="op">+</span><span class="st">&quot;-&quot;</span><span class="op">+</span>mes<span class="op">+</span><span class="st">&quot;-&quot;</span><span class="op">+</span>anio</span>
<span id="cb58-34"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-34" tabindex="-1"></a>    </span>
<span id="cb58-35"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-35" tabindex="-1"></a>    week_start_date<span class="op">=</span> datetime.strptime(week_start,<span class="st">&#39;</span><span class="sc">%d</span><span class="st">-%m-%Y&#39;</span>)</span>
<span id="cb58-36"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-36" tabindex="-1"></a></span>
<span id="cb58-37"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-37" tabindex="-1"></a>    </span>
<span id="cb58-38"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb58-38" tabindex="-1"></a>    <span class="cf">return</span> week_start_date</span></code></pre></div>
<p>Una vez construida la función se procede a aplicarla sobre el set de datos principal a través de una función tipo lambda:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb59-1" tabindex="-1"></a></span>
<span id="cb59-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb59-2" tabindex="-1"></a>df_sipsa[<span class="st">&quot;dia_inicio_semana&quot;</span>]<span class="op">=</span> df_sipsa[<span class="st">&quot;periodo&quot;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x:weekstart_conversor(x))</span></code></pre></div>
<p>Una vez aplicada la función se puede apreciar que la nueva columna “dia_inicio_semana” contiene ahora la fecha del primer dia de la semana que toma el boletín :</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb60-1" tabindex="-1"></a></span>
<span id="cb60-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb60-2" tabindex="-1"></a>df_sipsa[<span class="st">&quot;dia_inicio_semana&quot;</span>].head()</span></code></pre></div>
<pre><code>## 0   2016-12-10
## 1   2016-12-10
## 2   2016-12-10
## 3   2016-12-10
## 4   2016-12-10
## Name: dia_inicio_semana, dtype: datetime64[ns]</code></pre>
<p>Teniendo en cuenta que el proceso de normalización de la fecha ha sido exitoso se procede a filtrar unicamente las centrales de abasto de interés que en este caso son unicamente las que correspondan a Armenia y a Pereira, asi mismo solo resultan de interés los productos correspondientes a cebolla junca, habichuelas, tomate chonto y ahuyama;en la siguiente linea de código se ejecuta el filtrado del dataset:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb62-1" tabindex="-1"></a></span>
<span id="cb62-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb62-2" tabindex="-1"></a>centrales_interes<span class="op">=</span> [<span class="st">&#39;Armenia, Mercar&#39;</span>,<span class="st">&#39;Pereira, La 41&#39;</span>,<span class="st">&#39;Pereira, Mercasa&#39;</span>,<span class="st">&#39;Armenia, Retiro&#39;</span>]</span>
<span id="cb62-3"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb62-3" tabindex="-1"></a></span>
<span id="cb62-4"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb62-4" tabindex="-1"></a>productos<span class="op">=</span> [<span class="st">&#39;Cebolla junca&#39;</span>,<span class="st">&#39;Tomate chonto&#39;</span>,<span class="st">&#39;Ahuyama&#39;</span>,<span class="st">&#39;Habichuela&#39;</span>]</span>
<span id="cb62-5"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb62-5" tabindex="-1"></a></span>
<span id="cb62-6"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb62-6" tabindex="-1"></a>df_sipsa_reducido<span class="op">=</span> df_sipsa[df_sipsa[<span class="st">&quot;Mercado mayorista&quot;</span>].isin(centrales_interes)<span class="op">==</span><span class="va">True</span>]</span>
<span id="cb62-7"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb62-7" tabindex="-1"></a>df_sipsa_reducido<span class="op">=</span> df_sipsa_reducido[df_sipsa_reducido[<span class="st">&quot;Producto&quot;</span>].isin(productos)<span class="op">==</span><span class="va">True</span>]</span>
<span id="cb62-8"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb62-8" tabindex="-1"></a></span>
<span id="cb62-9"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb62-9" tabindex="-1"></a>df_sipsa_reducido.drop(columns<span class="op">=</span>[<span class="st">&quot;Tendencia&quot;</span>,<span class="st">&quot;periodo&quot;</span>,<span class="st">&quot;longitud&quot;</span>],inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<p>Ahora se cuenta con un set de datos con las siguientes columnas y extension:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb63-1" tabindex="-1"></a></span>
<span id="cb63-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb63-2" tabindex="-1"></a><span class="bu">print</span>(df_sipsa_reducido.shape)</span></code></pre></div>
<pre><code>## (4386, 6)</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb65-1" tabindex="-1"></a>df_sipsa_reducido.info</span></code></pre></div>
<pre><code>## &lt;bound method DataFrame.info of         Mercado mayorista Precio mínimo  ...       Producto dia_inicio_semana
## 19        Armenia, Mercar           500  ...        Ahuyama        2016-12-10
## 37         Pereira, La 41           700  ...        Ahuyama        2016-12-10
## 38       Pereira, Mercasa           700  ...        Ahuyama        2016-12-10
## 297       Armenia, Mercar          1143  ...  Cebolla junca        2016-12-10
## 310        Pereira, La 41          1067  ...  Cebolla junca        2016-12-10
## ...                   ...           ...  ...            ...               ...
## 1654767    Pereira, La 41          2400  ...     Habichuela        2022-01-29
## 1654768  Pereira, Mercasa          2800  ...     Habichuela        2022-01-29
## 1655038   Armenia, Mercar          2727  ...  Tomate chonto        2022-01-29
## 1655055    Pereira, La 41          3000  ...  Tomate chonto        2022-01-29
## 1655056  Pereira, Mercasa          3000  ...  Tomate chonto        2022-01-29
## 
## [4386 rows x 6 columns]&gt;</code></pre>
<p>El nuevo set de datos cuenta con 4386 registros y 6 columnas que corresponden exclusivamente a las centrales de abasto y productos de interés para el análisis.</p>
<p>Como puede observarse ya los datos y las fechas estan filtradas y normalizadas no obstante hace falta que la fecha sea el indice del set de datos, esta condición es de suma importancia para poder llevar a cabo de manera más eficiente ejercicios posteriores, para cumplir esta condición a nivel de estructura de tabla, se crea una tabla de fechas que contiene los dias de inicio de semana que deberian contener las series de tiempo de los alimentos, esto se hace con la finalidad de tener un marco de fechas completo que permita determinar datos faltantes en el set de datos en revisión, para crear esta tabla de fechas se crea la función rango_fechas() que a partir de una fecha de inicio, una fecha de finalización y una determinada cantidad de años genera un listado de dias en formato yyyy-mm-dd</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb67-1" tabindex="-1"></a></span>
<span id="cb67-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb67-2" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> timedelta</span>
<span id="cb67-3"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb67-3" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> date</span>
<span id="cb67-4"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb67-4" tabindex="-1"></a></span>
<span id="cb67-5"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb67-5" tabindex="-1"></a><span class="kw">def</span> rango_fechas(fecha_inicio,frecuencia,años):</span>
<span id="cb67-6"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb67-6" tabindex="-1"></a>    inicio<span class="op">=</span> fecha_inicio</span>
<span id="cb67-7"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb67-7" tabindex="-1"></a>    periodos<span class="op">=</span> <span class="bu">int</span>(<span class="bu">round</span>((<span class="dv">365</span><span class="op">/</span>frecuencia)<span class="op">*</span>años,<span class="dv">0</span>))</span>
<span id="cb67-8"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb67-8" tabindex="-1"></a>    lista<span class="op">=</span> <span class="bu">range</span>(<span class="dv">0</span>,periodos<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb67-9"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb67-9" tabindex="-1"></a>    factor_suma<span class="op">=</span> timedelta(days<span class="op">=</span>frecuencia)</span>
<span id="cb67-10"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb67-10" tabindex="-1"></a>    lista_final<span class="op">=</span>[]</span>
<span id="cb67-11"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb67-11" tabindex="-1"></a>    </span>
<span id="cb67-12"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb67-12" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> lista: </span>
<span id="cb67-13"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb67-13" tabindex="-1"></a>        <span class="cf">if</span> i<span class="op">==</span><span class="dv">0</span>:</span>
<span id="cb67-14"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb67-14" tabindex="-1"></a>            fecha<span class="op">=</span> inicio <span class="op">+</span> factor_suma<span class="op">*</span><span class="dv">0</span></span>
<span id="cb67-15"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb67-15" tabindex="-1"></a>            lista_final.append(fecha)</span>
<span id="cb67-16"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb67-16" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb67-17"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb67-17" tabindex="-1"></a>            fecha<span class="op">=</span> fecha <span class="op">+</span> factor_suma</span>
<span id="cb67-18"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb67-18" tabindex="-1"></a>            lista_final.append(fecha)</span>
<span id="cb67-19"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb67-19" tabindex="-1"></a>    </span>
<span id="cb67-20"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb67-20" tabindex="-1"></a>    df_fechas_final<span class="op">=</span> pd.DataFrame({<span class="st">&quot;Periodo&quot;</span>:lista_final})</span>
<span id="cb67-21"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb67-21" tabindex="-1"></a>    </span>
<span id="cb67-22"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb67-22" tabindex="-1"></a>    <span class="cf">return</span> df_fechas_final</span></code></pre></div>
<p>Se crea una variable de inicio con la primera fecha que muestra el set de datos, y en la función rango_fechas se introduce una frecuencia 7 (semanal) para un lapso de 7 años (2016-2022)</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb68-1" tabindex="-1"></a>start <span class="op">=</span> datetime(<span class="dv">2016</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb68-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb68-2" tabindex="-1"></a>tabla_fechas_referencia<span class="op">=</span> rango_fechas(start,<span class="dv">7</span>,<span class="dv">7</span>)</span>
<span id="cb68-3"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb68-3" tabindex="-1"></a>tabla_fechas_referencia[<span class="st">&quot;Año&quot;</span>]<span class="op">=</span> tabla_fechas_referencia[<span class="st">&quot;Periodo&quot;</span>].dt.year</span>
<span id="cb68-4"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb68-4" tabindex="-1"></a>tabla_fechas_referencia[<span class="st">&quot;Año-mes&quot;</span>]<span class="op">=</span> tabla_fechas_referencia[<span class="st">&quot;Periodo&quot;</span>].dt.to_period(<span class="st">&#39;M&#39;</span>)</span>
<span id="cb68-5"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb68-5" tabindex="-1"></a>tabla_fechas_referencia</span></code></pre></div>
<pre><code>##        Periodo   Año  Año-mes
## 0   2016-01-02  2016  2016-01
## 1   2016-01-09  2016  2016-01
## 2   2016-01-16  2016  2016-01
## 3   2016-01-23  2016  2016-01
## 4   2016-01-30  2016  2016-01
## ..         ...   ...      ...
## 361 2022-12-03  2022  2022-12
## 362 2022-12-10  2022  2022-12
## 363 2022-12-17  2022  2022-12
## 364 2022-12-24  2022  2022-12
## 365 2022-12-31  2022  2022-12
## 
## [366 rows x 3 columns]</code></pre>
<p>Con esta operación realizada se procede a crear una función más,esta función es get_tidy_ts() la cual busca realizar una reindexación de la tabla origen a una estructura de tabla en donde el indice sea la fecha y las columnas sean los productos asociados a cada central de abastos:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-1" tabindex="-1"></a></span>
<span id="cb70-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-2" tabindex="-1"></a><span class="kw">def</span> get_tidy_ts(df,mercado,tabla_fechas):</span>
<span id="cb70-3"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-3" tabindex="-1"></a>    </span>
<span id="cb70-4"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-4" tabindex="-1"></a>    productos<span class="op">=</span> df[df[<span class="st">&quot;Mercado mayorista&quot;</span>]<span class="op">==</span>mercado][<span class="st">&quot;Producto&quot;</span>].unique()</span>
<span id="cb70-5"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-5" tabindex="-1"></a>    </span>
<span id="cb70-6"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-6" tabindex="-1"></a>    dataframe_list<span class="op">=</span> []</span>
<span id="cb70-7"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-7" tabindex="-1"></a>    </span>
<span id="cb70-8"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-8" tabindex="-1"></a>           </span>
<span id="cb70-9"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-9" tabindex="-1"></a>    </span>
<span id="cb70-10"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-10" tabindex="-1"></a>    <span class="cf">for</span> producto <span class="kw">in</span> productos:</span>
<span id="cb70-11"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-11" tabindex="-1"></a>         match_producto<span class="op">=</span> df[(df[<span class="st">&quot;Producto&quot;</span>]<span class="op">==</span>producto)<span class="op">&amp;</span>(df[<span class="st">&quot;Mercado mayorista&quot;</span>]<span class="op">==</span>mercado)]<span class="op">\</span></span>
<span id="cb70-12"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-12" tabindex="-1"></a>                                        [[<span class="st">&quot;Producto&quot;</span>,<span class="st">&quot;dia_inicio_semana&quot;</span>,<span class="st">&quot;Precio medio&quot;</span>,<span class="st">&quot;Mercado mayorista&quot;</span>]]</span>
<span id="cb70-13"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-13" tabindex="-1"></a>         </span>
<span id="cb70-14"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-14" tabindex="-1"></a>         match_producto[<span class="st">&quot;prod-merc&quot;</span>]<span class="op">=</span> match_producto[<span class="st">&quot;Producto&quot;</span>]<span class="op">+</span><span class="st">&quot;_&quot;</span><span class="op">+</span>match_producto[<span class="st">&quot;Mercado mayorista&quot;</span>]</span>
<span id="cb70-15"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-15" tabindex="-1"></a>         </span>
<span id="cb70-16"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-16" tabindex="-1"></a>         match_producto.drop(columns<span class="op">=</span>{<span class="st">&quot;Mercado mayorista&quot;</span>},inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb70-17"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-17" tabindex="-1"></a>         </span>
<span id="cb70-18"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-18" tabindex="-1"></a>         calendar_merge<span class="op">=</span> tabla_fechas.merge(right<span class="op">=</span>match_producto,how<span class="op">=</span><span class="st">&quot;left&quot;</span>,left_on<span class="op">=</span><span class="st">&quot;Periodo&quot;</span>,right_on<span class="op">=</span><span class="st">&quot;dia_inicio_semana&quot;</span>)</span>
<span id="cb70-19"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-19" tabindex="-1"></a>         </span>
<span id="cb70-20"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-20" tabindex="-1"></a>         calendar_merge.drop_duplicates(subset<span class="op">=</span>[<span class="st">&quot;Periodo&quot;</span>],keep<span class="op">=</span><span class="st">&#39;first&#39;</span>,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb70-21"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-21" tabindex="-1"></a>         </span>
<span id="cb70-22"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-22" tabindex="-1"></a>         </span>
<span id="cb70-23"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-23" tabindex="-1"></a>         calendar_merge.drop(columns<span class="op">=</span>[<span class="st">&quot;dia_inicio_semana&quot;</span>,<span class="st">&quot;Año&quot;</span>,<span class="st">&quot;Año-mes&quot;</span>],inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb70-24"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-24" tabindex="-1"></a>         </span>
<span id="cb70-25"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-25" tabindex="-1"></a>         </span>
<span id="cb70-26"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-26" tabindex="-1"></a>         calendar_merge<span class="op">=</span> calendar_merge.pivot(index<span class="op">=</span><span class="st">&quot;Periodo&quot;</span>,columns<span class="op">=</span><span class="st">&quot;prod-merc&quot;</span>,values<span class="op">=</span><span class="st">&quot;Precio medio&quot;</span>).drop(columns<span class="op">=</span>np.nan)</span>
<span id="cb70-27"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-27" tabindex="-1"></a>            </span>
<span id="cb70-28"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-28" tabindex="-1"></a>         dataframe_list.append(calendar_merge)  </span>
<span id="cb70-29"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-29" tabindex="-1"></a>        </span>
<span id="cb70-30"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-30" tabindex="-1"></a>        </span>
<span id="cb70-31"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-31" tabindex="-1"></a>    tidy_ts_df<span class="op">=</span> pd.concat(dataframe_list, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb70-32"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-32" tabindex="-1"></a>    </span>
<span id="cb70-33"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-33" tabindex="-1"></a>    </span>
<span id="cb70-34"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-34" tabindex="-1"></a>    </span>
<span id="cb70-35"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb70-35" tabindex="-1"></a>    <span class="cf">return</span> tidy_ts_df</span></code></pre></div>
<p>Antes de aplicar la función anterior se procede a simplificar los nombres de las centrales de abastos:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb71-1" tabindex="-1"></a></span>
<span id="cb71-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb71-2" tabindex="-1"></a>simplificacion_centrales<span class="op">=</span>{<span class="st">&quot;Armenia, Mercar&quot;</span>:<span class="st">&quot;axm_merc&quot;</span>,<span class="st">&quot;Armenia, Retiro&quot;</span>:<span class="st">&quot;axm_ret&quot;</span>,</span>
<span id="cb71-3"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb71-3" tabindex="-1"></a><span class="st">&quot;Pereira, La 41&quot;</span>:<span class="st">&quot;per_l41&quot;</span>,<span class="st">&quot;Pereira, Mercasa&quot;</span>:<span class="st">&quot;per_merca&quot;</span>}</span>
<span id="cb71-4"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb71-4" tabindex="-1"></a></span>
<span id="cb71-5"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb71-5" tabindex="-1"></a>df_sipsa_reducido[<span class="st">&quot;Mercado mayorista&quot;</span>] <span class="op">=</span> df_sipsa_reducido[<span class="st">&quot;Mercado mayorista&quot;</span>].replace(simplificacion_centrales)</span></code></pre></div>
<p>Con la operación anterior realizada se procede a generar una dataset reformateado para los alimentos de interés en la ciudad de Armenia usando la función get_tidy_ts():</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb72-1" tabindex="-1"></a></span>
<span id="cb72-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb72-2" tabindex="-1"></a>centrales_armenia<span class="op">=</span>  [<span class="st">&#39;axm_merc&#39;</span>]</span>
<span id="cb72-3"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb72-3" tabindex="-1"></a></span>
<span id="cb72-4"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb72-4" tabindex="-1"></a>lista_df_axm<span class="op">=</span> []</span>
<span id="cb72-5"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb72-5" tabindex="-1"></a></span>
<span id="cb72-6"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb72-6" tabindex="-1"></a><span class="cf">for</span> central <span class="kw">in</span> centrales_armenia:</span>
<span id="cb72-7"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb72-7" tabindex="-1"></a>    df_central2<span class="op">=</span>get_tidy_ts(df_sipsa_reducido,central,tabla_fechas_referencia)</span>
<span id="cb72-8"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb72-8" tabindex="-1"></a>    lista_df_axm.append(df_central2)</span>
<span id="cb72-9"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb72-9" tabindex="-1"></a></span>
<span id="cb72-10"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb72-10" tabindex="-1"></a>df_tseries_axm<span class="op">=</span> pd.concat(lista_df_axm,axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb72-11"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb72-11" tabindex="-1"></a></span>
<span id="cb72-12"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb72-12" tabindex="-1"></a>df_tseries_axm</span></code></pre></div>
<pre><code>## prod-merc  Ahuyama_axm_merc  ... Tomate chonto_axm_merc
## Periodo                      ...                       
## 2016-01-02             1300  ...                   2383
## 2016-01-09             1233  ...                   2300
## 2016-01-16             1233  ...                   2600
## 2016-01-23             1078  ...                   1867
## 2016-01-30              828  ...                   1383
## ...                     ...  ...                    ...
## 2022-12-03             1267  ...                   1970
## 2022-12-10             1267  ...                   2045
## 2022-12-17             1267  ...                   2197
## 2022-12-24             1267  ...                   2197
## 2022-12-31              NaN  ...                    NaN
## 
## [366 rows x 4 columns]</code></pre>
<p>Ahora se cuenta con un set de datos con 366 registros y 4 columnas que corresponden a los precios de los productos de interesm, ahora repliquemos el mismo ejercicio para la ciudad de Pereira:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb74-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb74-1" tabindex="-1"></a></span>
<span id="cb74-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb74-2" tabindex="-1"></a>centrales_pereira<span class="op">=</span>  [<span class="st">&#39;per_merca&#39;</span>]</span>
<span id="cb74-3"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb74-3" tabindex="-1"></a></span>
<span id="cb74-4"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb74-4" tabindex="-1"></a>lista_df_per<span class="op">=</span> []</span>
<span id="cb74-5"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb74-5" tabindex="-1"></a></span>
<span id="cb74-6"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb74-6" tabindex="-1"></a><span class="cf">for</span> central <span class="kw">in</span> centrales_pereira:</span>
<span id="cb74-7"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb74-7" tabindex="-1"></a>    df_central3<span class="op">=</span>get_tidy_ts(df_sipsa_reducido,central,tabla_fechas_referencia)</span>
<span id="cb74-8"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb74-8" tabindex="-1"></a>    lista_df_per.append(df_central3)</span>
<span id="cb74-9"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb74-9" tabindex="-1"></a></span>
<span id="cb74-10"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb74-10" tabindex="-1"></a>df_tseries_per<span class="op">=</span> pd.concat(lista_df_per,axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb74-11"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb74-11" tabindex="-1"></a></span>
<span id="cb74-12"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb74-12" tabindex="-1"></a>df_tseries_per</span></code></pre></div>
<pre><code>## prod-merc  Ahuyama_per_merca  ... Tomate chonto_per_merca
## Periodo                       ...                        
## 2016-01-02              1333  ...                    2217
## 2016-01-09              1167  ...                    2844
## 2016-01-16              1183  ...                    3371
## 2016-01-23              1117  ...                    1900
## 2016-01-30               967  ...                    1738
## ...                      ...  ...                     ...
## 2022-12-03              1625  ...                    3342
## 2022-12-10              1542  ...                    3450
## 2022-12-17              1567  ...                    3508
## 2022-12-24              1633  ...                    3333
## 2022-12-31               NaN  ...                     NaN
## 
## [366 rows x 4 columns]</code></pre>
<p>Con los sets de datos en el formato adecuado, como ultimo ejercicio se procede a revisar la integridad de las series de tiempo en cada conjunto de datos haciendo uso del método isnull() de Python:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb76-1" tabindex="-1"></a></span>
<span id="cb76-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb76-2" tabindex="-1"></a></span>
<span id="cb76-3"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb76-3" tabindex="-1"></a>df_tseries_axm.isnull().<span class="bu">sum</span>()</span></code></pre></div>
<pre><code>## prod-merc
## Ahuyama_axm_merc          11
## Cebolla junca_axm_merc    12
## Habichuela_axm_merc       11
## Tomate chonto_axm_merc    12
## dtype: int64</code></pre>
<p>Se puede apreciar que para el caso de Armenia hay entre 11 y 12 registros faltantes por serie, lo cual significa que hay un 3% de valores faltantes por serie respecto al valor total de registros por producto.</p>
<p>En el caso de Pereira se aprecia lo siguiente:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb78-1" tabindex="-1"></a></span>
<span id="cb78-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb78-2" tabindex="-1"></a>df_tseries_per.isnull().<span class="bu">sum</span>()</span></code></pre></div>
<pre><code>## prod-merc
## Ahuyama_per_merca          11
## Cebolla junca_per_merca    12
## Habichuela_per_merca       11
## Tomate chonto_per_merca    12
## dtype: int64</code></pre>
<p>Para el caso de Pereira tambien se cumple una condición de ausencia de entre 11 y 12 registros por serie de tiempo.</p>
<p>Para solucionar el problema de valores faltantes y tener finalmente los sets de datos listo para la fase exploratoria se hace uso de la variable interpolate de pandas usando el método “time”, para poder aplicar esto de manera efectiva se realiza el casteo de las variables de precio con el fin de que pasen de formato string a formato númerico:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb80-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb80-1" tabindex="-1"></a></span>
<span id="cb80-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb80-2" tabindex="-1"></a>df_tseries_axm<span class="op">=</span> df_tseries_axm.<span class="bu">apply</span>(pd.to_numeric)</span>
<span id="cb80-3"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb80-3" tabindex="-1"></a>ts_columns_axm<span class="op">=</span> df_tseries_axm.columns </span>
<span id="cb80-4"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb80-4" tabindex="-1"></a></span>
<span id="cb80-5"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb80-5" tabindex="-1"></a><span class="cf">for</span> ts <span class="kw">in</span> ts_columns_axm:</span>
<span id="cb80-6"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb80-6" tabindex="-1"></a>    df_tseries_axm[ts]<span class="op">=</span> df_tseries_axm[ts].interpolate(method<span class="op">=</span><span class="st">&quot;time&quot;</span>)</span>
<span id="cb80-7"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb80-7" tabindex="-1"></a>    </span>
<span id="cb80-8"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb80-8" tabindex="-1"></a>    </span>
<span id="cb80-9"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb80-9" tabindex="-1"></a></span>
<span id="cb80-10"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb80-10" tabindex="-1"></a>df_tseries_per<span class="op">=</span> df_tseries_per.<span class="bu">apply</span>(pd.to_numeric)</span>
<span id="cb80-11"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb80-11" tabindex="-1"></a>ts_columns_per<span class="op">=</span> df_tseries_per.columns </span>
<span id="cb80-12"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb80-12" tabindex="-1"></a></span>
<span id="cb80-13"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb80-13" tabindex="-1"></a><span class="cf">for</span> ts <span class="kw">in</span> ts_columns_per:</span>
<span id="cb80-14"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb80-14" tabindex="-1"></a>    df_tseries_per[ts]<span class="op">=</span> df_tseries_per[ts].interpolate(method<span class="op">=</span><span class="st">&quot;time&quot;</span>)</span></code></pre></div>
<p>Finalmente al revisar nuevamente los valores vacios en las series se tiene lo siguiente:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb81-1" tabindex="-1"></a></span>
<span id="cb81-2"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb81-2" tabindex="-1"></a>df_tseries_per.isnull().<span class="bu">sum</span>()</span></code></pre></div>
<pre><code>## prod-merc
## Ahuyama_per_merca          0
## Cebolla junca_per_merca    0
## Habichuela_per_merca       0
## Tomate chonto_per_merca    0
## dtype: int64</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb83-1"><a href="recolección-carga-y-transformación-de-los-datos-de-precios-semanales.html#cb83-1" tabindex="-1"></a>df_tseries_axm.isnull().<span class="bu">sum</span>()</span></code></pre></div>
<pre><code>## prod-merc
## Ahuyama_axm_merc          0
## Cebolla junca_axm_merc    0
## Habichuela_axm_merc       0
## Tomate chonto_axm_merc    0
## dtype: int64</code></pre>
<p>Con la serie de operaciones realizadas ahora se cuenta con dos sets de datos en formato correcto para poder llevar a cabo procesos de análisis exploratorio que permitan determinar las propiedades de las series de los alimentos en la central mayorista más representativa de cada ciudad.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="análisis-exploratorio-de-las-series-de-tiempo.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/01-RecTransfyCarg.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
